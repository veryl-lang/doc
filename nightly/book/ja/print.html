<!DOCTYPE HTML>
<html lang="ja" class="light" dir="ltr">
    <head prefix="og: http://ogp.me/ns#">
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>The Veryl Hardware Description Language</title>
        <meta name="robots" content="noindex">


        <!-- Custom HTML head -->
        <!-- Google tag (gtag.js) -->
        <script async src="https://www.googletagmanager.com/gtag/js?id=G-NXW2P6CCF3"></script>
        <script>
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
        
            gtag('config', 'G-NXW2P6CCF3');
        </script>
        
        <script>
            (function () {
                // See these pages for details:
                // https://developers.google.com/search/docs/crawling-indexing/consolidate-duplicate-urls
                // https://developers.google.com/search/docs/crawling-indexing/javascript/javascript-seo-basics
                let base = "https://doc.veryl-lang.org/book";
        let canonical_href = `${base}/ja/print.md`;

                // mdbook gives us a string ending in ".md", we replace it with ".html":
                canonical_href = canonical_href.slice(0, -"md".length) + "html";
                if (canonical_href.endsWith("/index.html")) {
                    canonical_href = canonical_href.slice(0, -"index.html".length);
                }
        
                let link = document.createElement("link");
                link.rel = "canonical";
                link.href = canonical_href;
                document.head.appendChild(link);
            })()
        </script>
        
        <meta property="og:url" content="https://github.com/veryl-lang/veryl" />
        <meta property="og:title" content="Veryl: A Modern Hardware Description Language" />
        <meta property="og:description" content="Veryl is a hardware description language which is designed as a SystemVerilog alternative." />
        <meta property="og:image" content="https://github.com/veryl-lang/veryl/raw/master/support/logo/veryl_ogp.png" />

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="theme/css/language-picker.css">

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="01_introduction.html"><strong aria-hidden="true">1.</strong> 概要</a></li><li class="chapter-item expanded "><a href="02_features.html"><strong aria-hidden="true">2.</strong> 特徴</a></li><li class="chapter-item expanded "><a href="03_getting_started.html"><strong aria-hidden="true">3.</strong> はじめに</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="03_getting_started/01_installation.html"><strong aria-hidden="true">3.1.</strong> インストール</a></li><li class="chapter-item "><a href="03_getting_started/02_hello_world.html"><strong aria-hidden="true">3.2.</strong> Hello, World!</a></li></ol></li><li class="chapter-item expanded "><a href="04_code_examples.html"><strong aria-hidden="true">4.</strong> コード例</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="04_code_examples/01_module.html"><strong aria-hidden="true">4.1.</strong> モジュール</a></li><li class="chapter-item "><a href="04_code_examples/02_instantiation.html"><strong aria-hidden="true">4.2.</strong> インスタンス</a></li><li class="chapter-item "><a href="04_code_examples/03_interface.html"><strong aria-hidden="true">4.3.</strong> インターフェース</a></li><li class="chapter-item "><a href="04_code_examples/04_package.html"><strong aria-hidden="true">4.4.</strong> パッケージ</a></li></ol></li><li class="chapter-item expanded "><a href="05_language_reference.html"><strong aria-hidden="true">5.</strong> 言語リファレンス</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="05_language_reference/01_source_code_structure.html"><strong aria-hidden="true">5.1.</strong> ソースコードの構造</a></li><li class="chapter-item "><a href="05_language_reference/02_lexical_structure.html"><strong aria-hidden="true">5.2.</strong> 字句構造</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="05_language_reference/02_lexical_structure/01_operator.html"><strong aria-hidden="true">5.2.1.</strong> 演算子</a></li><li class="chapter-item "><a href="05_language_reference/02_lexical_structure/02_number.html"><strong aria-hidden="true">5.2.2.</strong> 数値</a></li><li class="chapter-item "><a href="05_language_reference/02_lexical_structure/03_array_literal.html"><strong aria-hidden="true">5.2.3.</strong> 配列リテラル</a></li></ol></li><li class="chapter-item "><a href="05_language_reference/03_data_type.html"><strong aria-hidden="true">5.3.</strong> データ型</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="05_language_reference/03_data_type/01_builtin_type.html"><strong aria-hidden="true">5.3.1.</strong> 組み込み型</a></li><li class="chapter-item "><a href="05_language_reference/03_data_type/02_user_defined_type.html"><strong aria-hidden="true">5.3.2.</strong> ユーザ定義型</a></li><li class="chapter-item "><a href="05_language_reference/03_data_type/03_array.html"><strong aria-hidden="true">5.3.3.</strong> 配列</a></li><li class="chapter-item "><a href="05_language_reference/03_data_type/04_clock_reset.html"><strong aria-hidden="true">5.3.4.</strong> クロックとリセット</a></li></ol></li><li class="chapter-item "><a href="05_language_reference/04_expression.html"><strong aria-hidden="true">5.4.</strong> 式</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="05_language_reference/04_expression/01_operator_precedence.html"><strong aria-hidden="true">5.4.1.</strong> 演算子の優先順位</a></li><li class="chapter-item "><a href="05_language_reference/04_expression/02_function_call.html"><strong aria-hidden="true">5.4.2.</strong> 関数呼び出し</a></li><li class="chapter-item "><a href="05_language_reference/04_expression/03_concatenation.html"><strong aria-hidden="true">5.4.3.</strong> 連結</a></li><li class="chapter-item "><a href="05_language_reference/04_expression/04_if.html"><strong aria-hidden="true">5.4.4.</strong> if</a></li><li class="chapter-item "><a href="05_language_reference/04_expression/05_case.html"><strong aria-hidden="true">5.4.5.</strong> case</a></li><li class="chapter-item "><a href="05_language_reference/04_expression/06_bit_select.html"><strong aria-hidden="true">5.4.6.</strong> ビット選択</a></li><li class="chapter-item "><a href="05_language_reference/04_expression/07_range.html"><strong aria-hidden="true">5.4.7.</strong> 範囲</a></li><li class="chapter-item "><a href="05_language_reference/04_expression/08_msb_lsb.html"><strong aria-hidden="true">5.4.8.</strong> msb / lsb</a></li><li class="chapter-item "><a href="05_language_reference/04_expression/09_inside_outside.html"><strong aria-hidden="true">5.4.9.</strong> inside / outside</a></li></ol></li><li class="chapter-item "><a href="05_language_reference/05_statement.html"><strong aria-hidden="true">5.5.</strong> 文</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="05_language_reference/05_statement/01_assignment.html"><strong aria-hidden="true">5.5.1.</strong> 代入</a></li><li class="chapter-item "><a href="05_language_reference/05_statement/02_function_call.html"><strong aria-hidden="true">5.5.2.</strong> 関数呼び出し</a></li><li class="chapter-item "><a href="05_language_reference/05_statement/03_if.html"><strong aria-hidden="true">5.5.3.</strong> if</a></li><li class="chapter-item "><a href="05_language_reference/05_statement/04_case.html"><strong aria-hidden="true">5.5.4.</strong> case</a></li><li class="chapter-item "><a href="05_language_reference/05_statement/05_for.html"><strong aria-hidden="true">5.5.5.</strong> for</a></li><li class="chapter-item "><a href="05_language_reference/05_statement/06_return.html"><strong aria-hidden="true">5.5.6.</strong> return</a></li><li class="chapter-item "><a href="05_language_reference/05_statement/07_let.html"><strong aria-hidden="true">5.5.7.</strong> let</a></li></ol></li><li class="chapter-item "><a href="05_language_reference/06_declaration.html"><strong aria-hidden="true">5.6.</strong> 宣言</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="05_language_reference/06_declaration/01_variable.html"><strong aria-hidden="true">5.6.1.</strong> 変数</a></li><li class="chapter-item "><a href="05_language_reference/06_declaration/02_parameter.html"><strong aria-hidden="true">5.6.2.</strong> パラメータ</a></li><li class="chapter-item "><a href="05_language_reference/06_declaration/03_register.html"><strong aria-hidden="true">5.6.3.</strong> レジスタ</a></li><li class="chapter-item "><a href="05_language_reference/06_declaration/04_combinational.html"><strong aria-hidden="true">5.6.4.</strong> 組み合わせ回路</a></li><li class="chapter-item "><a href="05_language_reference/06_declaration/05_assign.html"><strong aria-hidden="true">5.6.5.</strong> assign</a></li><li class="chapter-item "><a href="05_language_reference/06_declaration/06_function.html"><strong aria-hidden="true">5.6.6.</strong> 関数</a></li><li class="chapter-item "><a href="05_language_reference/06_declaration/07_initial_final.html"><strong aria-hidden="true">5.6.7.</strong> initial / final</a></li><li class="chapter-item "><a href="05_language_reference/06_declaration/08_attribute.html"><strong aria-hidden="true">5.6.8.</strong> アトリビュート</a></li><li class="chapter-item "><a href="05_language_reference/06_declaration/09_generate.html"><strong aria-hidden="true">5.6.9.</strong> 生成</a></li><li class="chapter-item "><a href="05_language_reference/06_declaration/10_instantiation.html"><strong aria-hidden="true">5.6.10.</strong> インスタンス</a></li><li class="chapter-item "><a href="05_language_reference/06_declaration/11_named_block.html"><strong aria-hidden="true">5.6.11.</strong> 名前付きブロック</a></li><li class="chapter-item "><a href="05_language_reference/06_declaration/12_import_export.html"><strong aria-hidden="true">5.6.12.</strong> Import / Export</a></li></ol></li><li class="chapter-item "><a href="05_language_reference/07_module.html"><strong aria-hidden="true">5.7.</strong> モジュール</a></li><li class="chapter-item "><a href="05_language_reference/08_interface.html"><strong aria-hidden="true">5.8.</strong> インターフェース</a></li><li class="chapter-item "><a href="05_language_reference/09_package.html"><strong aria-hidden="true">5.9.</strong> パッケージ</a></li><li class="chapter-item "><a href="05_language_reference/10_systemverilog_interoperation.html"><strong aria-hidden="true">5.10.</strong> SystemVerilogとの相互運用</a></li><li class="chapter-item "><a href="05_language_reference/11_visibility.html"><strong aria-hidden="true">5.11.</strong> 可視性</a></li><li class="chapter-item "><a href="05_language_reference/12_foreign_language_integration.html"><strong aria-hidden="true">5.12.</strong> 他言語組み込み</a></li><li class="chapter-item "><a href="05_language_reference/13_integrated_test.html"><strong aria-hidden="true">5.13.</strong> 組み込みテスト</a></li><li class="chapter-item "><a href="05_language_reference/14_generics.html"><strong aria-hidden="true">5.14.</strong> ジェネリクス</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="05_language_reference/14_generics/01_default_parameter.html"><strong aria-hidden="true">5.14.1.</strong> デフォルトパラメータ</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="06_development_environment.html"><strong aria-hidden="true">6.</strong> 開発環境</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="06_development_environment/01_project_configuration.html"><strong aria-hidden="true">6.1.</strong> プロジェクト設定</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="06_development_environment/01_project_configuration/01_build.html"><strong aria-hidden="true">6.1.1.</strong> Build</a></li><li class="chapter-item "><a href="06_development_environment/01_project_configuration/02_format.html"><strong aria-hidden="true">6.1.2.</strong> Format</a></li><li class="chapter-item "><a href="06_development_environment/01_project_configuration/03_lint.html"><strong aria-hidden="true">6.1.3.</strong> Lint</a></li><li class="chapter-item "><a href="06_development_environment/01_project_configuration/04_test.html"><strong aria-hidden="true">6.1.4.</strong> Test</a></li><li class="chapter-item "><a href="06_development_environment/01_project_configuration/05_publish.html"><strong aria-hidden="true">6.1.5.</strong> Publish</a></li></ol></li><li class="chapter-item "><a href="06_development_environment/02_dependencies.html"><strong aria-hidden="true">6.2.</strong> 依存関係</a></li><li class="chapter-item "><a href="06_development_environment/03_publish_project.html"><strong aria-hidden="true">6.3.</strong> プロジェクトを公開する</a></li><li class="chapter-item "><a href="06_development_environment/04_directory_layout.html"><strong aria-hidden="true">6.4.</strong> ディレクトリ構成</a></li><li class="chapter-item "><a href="06_development_environment/05_formatter.html"><strong aria-hidden="true">6.5.</strong> フォーマッタ</a></li><li class="chapter-item "><a href="06_development_environment/06_linter.html"><strong aria-hidden="true">6.6.</strong> リンタ</a></li><li class="chapter-item "><a href="06_development_environment/07_simulator.html"><strong aria-hidden="true">6.7.</strong> シミュレータ</a></li><li class="chapter-item "><a href="06_development_environment/08_language_server.html"><strong aria-hidden="true">6.8.</strong> 言語サーバ</a></li><li class="chapter-item "><a href="06_development_environment/09_compatibility.html"><strong aria-hidden="true">6.9.</strong> 互換性</a></li><li class="chapter-item "><a href="06_development_environment/10_documentation.html"><strong aria-hidden="true">6.10.</strong> ドキュメンテーション</a></li><li class="chapter-item "><a href="06_development_environment/11_github_action.html"><strong aria-hidden="true">6.11.</strong> GitHub Action</a></li></ol></li><li class="chapter-item expanded "><a href="07_appendix.html"><strong aria-hidden="true">7.</strong> 補遺</a><a class="toggle"><div>❱</div></a></li><li><ol class="section"><li class="chapter-item "><a href="07_appendix/01_formal_syntax.html"><strong aria-hidden="true">7.1.</strong> 構文</a></li><li class="chapter-item "><a href="07_appendix/02_semantic_error.html"><strong aria-hidden="true">7.2.</strong> セマンティックエラー</a></li></ol></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">The Veryl Hardware Description Language</h1>

                    <div class="right-buttons">
                        <button id="language-toggle" class="icon-button" type="button"
                                title="Change language" aria-label="Change language"
                                aria-haspopup="true" aria-expanded="false"
                                aria-controls="language-list">
                            <i class="fa fa-globe"></i>
                        </button>
                        <ul id="language-list" class="theme-popup" aria-label="Languages" role="menu">
                          <li role="none"><button role="menuitem" class="theme">
                              <a id="en">English</a>
                          </button></li>
                          <li role="none"><button role="menuitem" class="theme">
                              <a id="ja">日本語</a>
                          </button></li>
                        </ul>

                        <script>
                          let langToggle = document.getElementById("language-toggle");
                          let langList = document.getElementById("language-list");
                          langToggle.addEventListener("click", (event) => {
                              langList.style.display = langList.style.display == "block" ? "none" : "block";
                          });
                          let selectedLang = document.getElementById("ja");
                          if (selectedLang) {
                              selectedLang.parentNode.classList.add("theme-selected");
                          }

                          // The path to the root, taking the current
                          // language into account.
                          let full_path_to_root = "../";
                          // The page path (mdbook only gives us
                          // access to the path to the Markdown file).
                          let path = "print.md".replace(/\.md$/, ".html");
                          for (let lang of langList.querySelectorAll("a")) {
                              if (lang.id == "en") {
                                  lang.href = `${full_path_to_root}${path}`;
                              } else {
                                  lang.href = `${full_path_to_root}${lang.id}/${path}`;
                              }
                          }
                        </script>

                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ハードウェア記述言語-veryl"><a class="header" href="#ハードウェア記述言語-veryl">ハードウェア記述言語 Veryl</a></h1>
<p><img src="https://github.com/veryl-lang/veryl/raw/master/support/logo/veryl_wide.png" alt="Veryl" /></p>
<p>Veryl は SystemVerilog をベースに設計されたハードウェア記述言語であり、以下のような特徴があります。</p>
<h2 id="最適化された構文"><a class="header" href="#最適化された構文">最適化された構文</a></h2>
<p>Verylは、SystemVerilogの経験者にとって親しみやすい基本構文に基づきながら、論理設計に最適化された構文を採用しています。この最適化には、たとえば合成可能性の保証やシミュレーション結果の一致の保証、頻出する定型文を簡素化する多数の構文などの提供が含まれます。このアプローチにより、学習の容易さ、設計プロセスの信頼性と効率の向上、およびコードの記述の容易さが実現されます。</p>
<h2 id="相互運用性"><a class="header" href="#相互運用性">相互運用性</a></h2>
<p>VerylはSystemVerilogとの相互運用性を考慮して設計されており、既存のSystemVerilogコンポーネントやプロジェクトとの組み合わせや部分的な置き換えをスムーズに行うことができます。さらに、VerylからトランスパイルされたSystemVerilogソースコードは、その高い可読性により、シームレスな統合やデバッグを可能にします。</p>
<h2 id="生産性"><a class="header" href="#生産性">生産性</a></h2>
<p>Verylはパッケージマネージャ、ビルドツール、そしてVSCode、Vim、Emacsなどの主要なエディタに対応するリアルタイムチェッカー、自動補完機能、自動フォーマッタなど、豊富な開発支援ツールを備えています。これらのツールは、開発プロセスを加速し、生産性を大幅に向上させることができます。</p>
<p>これらの特性により、Verylは設計者が高品質なハードウェア設計をより効率的かつ生産的に行うための強力なサポートを提供します。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="特徴"><a class="header" href="#特徴">特徴</a></h1>
<p>この章ではVerylの特徴的な機能をわかりやすい例とともに紹介します。</p>
<ul>
<li><a href="02_features.html#real-time-diagnostics">リアルタイム診断</a></li>
<li><a href="02_features.html#auto-formatting">自動フォーマット</a></li>
<li><a href="02_features.html#integrated-test">組み込みテスト</a></li>
<li><a href="02_features.html#dependency-management">依存関係管理</a></li>
<li><a href="02_features.html#generics">ジェネリクス</a></li>
<li><a href="02_features.html#trailing-comma">末尾カンマ</a></li>
<li><a href="02_features.html#abstraction-of-clock-and-reset">クロックとリセットの抽象化</a></li>
<li><a href="02_features.html#documentation-comment">ドキュメンテーションコメント</a></li>
<li><a href="02_features.html#compound-assignment-operator-in-always_ff"><code>always_ff</code> での複合代入演算子</a></li>
<li><a href="02_features.html#individual-namespace-of-enum-variant">独立した名前空間を持つenumバリアント</a></li>
<li><a href="02_features.html#repeat-of-concatenation">ビット連結における <code>repeat</code></a></li>
<li><a href="02_features.html#if--case-expression"><code>if</code> / <code>case</code> 式</a></li>
<li><a href="02_features.html#range-based-for--inside--outside">範囲 <code>for</code> / <code>inside</code> / <code>outside</code></a></li>
<li><a href="02_features.html#msb-notation"><code>msb</code> 記法</a></li>
<li><a href="02_features.html#let-statement"><code>let</code> 文</a></li>
<li><a href="02_features.html#named-block">名前付きブロック</a></li>
<li><a href="02_features.html#visibility-control">可視性制御</a></li>
</ul>
<h2 id="real-time-diagnostics"><a class="header" href="#real-time-diagnostics">リアルタイム診断</a></h2>
<p>変数の未定義・未使用・未代入といった問題はエディタでの編集中にリアルタイムに通知されます。次の例では、未使用変数として通知された変数に <code>_</code> プレフィックスを付加することで未使用であることを明示し、警告を抑制しています。</p>
<p><img src="./img/diagnostics.gif" alt="diagnostics" /></p>
<p>ビデオが再生されない場合<sup class="footnote-reference"><a href="#1">1</a></sup></p>
<h2 id="auto-formatting"><a class="header" href="#auto-formatting">自動フォーマット</a></h2>
<p>エディタと連携した自動フォーマット機能のほか、コマンドラインでのフォーマットやCIでのフォーマットチェックも可能です。</p>
<p><img src="./img/format.gif" alt="format" /></p>
<p>ビデオが再生されない場合<sup class="footnote-reference"><a href="#1">1</a></sup></p>
<h2 id="integrated-test"><a class="header" href="#integrated-test">組み込みテスト</a></h2>
<p>SystemVerilogで書かれたテストコードをVerylに埋め込み、<code>veryl test</code> コマンドで実行することができます。</p>
<pre><code class="language-veryl">#[test(test1)]
embed (inline) sv{{{
    module test1;
        initial begin
            assert (0) else $error("error");
        end
    endmodule
}}}
</code></pre>
<h2 id="dependency-management"><a class="header" href="#dependency-management">依存関係管理</a></h2>
<p>Verylには依存関係の管理機能が組み込まれており、プロジェクト設定に以下のようにライブラリのリポジトリパスとバージョンを追加するだけで、簡単にライブラリを組み込むことができます。</p>
<pre><code class="language-toml">[dependencies]
"https://github.com/veryl-lang/sample" = "0.1.0"
</code></pre>
<h2 id="generics"><a class="header" href="#generics">ジェネリクス</a></h2>
<p>ジェネリクスによるコード生成は従来のパラメータオーバーライドよりさらに再利用性の高いコードを記述することができます。以下の例のような関数のパラメータだけでなく、インスタンスのモジュール名や構造体定義の型名もパラメータ化することができます。</p>
<table>
<tr>
<th>SystemVerilog</th>
<th>Veryl</th>
</tr>
<tr>
<td>
<pre><code class="language-verilog">function automatic logic [20-1:0] FuncA_20 (
    input logic [20-1:0] a
);
    return a + 1;
endfunction

function automatic logic [10-1:0] FuncA_10 (
    input logic [10-1:0] a
);
    return a + 1;
endfunction

logic [10-1:0] a;
logic [20-1:0] b;
always_comb begin
    a = FuncA_10(1);
    b = FuncA_20(1);
end
</code></pre>
</td>
<td>
<pre><code class="language-veryl">function FuncA::&lt;T&gt; (
    a: input logic&lt;T&gt;,
) -&gt; logic&lt;T&gt; {
    return a + 1;
}

var a: logic&lt;10&gt;;
var b: logic&lt;10&gt;;
always_comb {
    a = FuncA::&lt;10&gt;(1);
    b = FuncA::&lt;20&gt;(1);
}
</code></pre>
</td>
</tr>
</table>
<h2 id="trailing-comma"><a class="header" href="#trailing-comma">末尾カンマ</a></h2>
<p>末尾カンマは、リストの最後の要素の後ろにカンマが置かれる構文です。これにより、要素の追加や削除が容易になり、バージョン管理システムにおける不必要な差異を減らすことができます。</p>
<table>
<tr>
<th>SystemVerilog</th>
<th>Veryl</th>
</tr>
<tr>
<td>
<pre><code class="language-verilog">module ModuleA (
    input  a,
    input  b,
    output o
);
endmodule
</code></pre>
</td>
<td>
<pre><code class="language-veryl">module ModuleA (
    a: input logic,
    b: input logic,
    o: input logic,
) {
}
</code></pre>
</td>
</tr>
</table>
<h2 id="abstraction-of-clock-and-reset"><a class="header" href="#abstraction-of-clock-and-reset">クロックとリセットの抽象化</a></h2>
<p>クロックの極性やリセットの極性と同期性を構文上指定する必要はなく、ビルド時の設定で指定することができます。これにより同じVerylのコードからASIC向けの負極性・非同期リセットとFPGA向けの正極性・同期リセットのそれぞれのコードを生成することができます。</p>
<p>さらに、明示的な <code>clock</code> と <code>reset</code> 型により、レジスタへのクロック・リセット接続が正しく行われているかどうかを確認することができます。モジュール内にクロックとリセットが1つだけの場合、レジスタへの接続を省略することもできます。</p>
<table>
<tr>
<th>SystemVerilog</th>
<th>Veryl</th>
</tr>
<tr>
<td>
<pre><code class="language-verilog">module ModuleA (
    input logic i_clk,
    input logic i_rst_n
);

always_ff @ (posedge i_clk or negedge i_rst_n) begin
    if (!i_rst_n) begin
    end else begin
    end
end

endmodule
</code></pre>
</td>
<td>
<pre><code class="language-veryl">module ModuleA (
    i_clk: input clock,
    i_rst: input reset,
){
    always_ff {
        if_reset {
        } else {
        }
    }
}
</code></pre>
</td>
</tr>
</table>
<h2 id="documentation-comment"><a class="header" href="#documentation-comment">ドキュメンテーションコメント</a></h2>
<p>ドキュメンテーションコメントとしてモジュールの説明を書いておくとドキュメントを自動生成することができます。単なるテキストだけでなく、マークダウン形式や<a href="https://wavedrom.com">WaveDrom</a>による波形記述を使用することができます。</p>
<table>
<tr>
<th>SystemVerilog</th>
<th>Veryl</th>
</tr>
<tr>
<td>
<pre><code class="language-verilog">// コメント
module ModuleA;
endmodule
</code></pre>
</td>
<td>
<pre><code class="language-veryl">/// Documentation comment written by Markdown
///
/// * list
/// * list
/// 
/// ```wavedrom
/// { signal: [{ name: "Alfa", wave: "01.zx=ud.23.456789" }] }
/// ```
module ModuleA {
}
</code></pre>
</td>
</tr>
</table>
<h2 id="compound-assignment-operator-in-always_ff"><a class="header" href="#compound-assignment-operator-in-always_ff"><code>always_ff</code> での複合代入演算子</a></h2>
<p>ノンブロッキング専用の代入演算子はなく、<code>always_ff</code> 内ではノンブロッキング代入が、 <code>always_comb</code> 内ではブロッキング代入が推論されます。そのため <code>always_ff</code> 内でも <code>always_comb</code> 内と同様に様々な複合代入演算子を使用することができます。</p>
<table>
<tr>
<th>SystemVerilog</th>
<th>Veryl</th>
</tr>
<tr>
<td>
<pre><code class="language-verilog">always_ff @ (posedge i_clk) begin
    if (a) begin
        x &lt;= x + 1;
    end
end
</code></pre>
</td>
<td>
<pre><code class="language-veryl">always_ff {
    if a {
        x += 1;
    }
}
</code></pre>
</td>
</tr>
</table>
<h2 id="individual-namespace-of-enum-variant"><a class="header" href="#individual-namespace-of-enum-variant">独立した名前空間を持つenumバリアント</a></h2>
<p>enumのバリアントはenum毎に独立した名前空間を持っており意図しない名前の衝突を防ぐことができます。</p>
<table>
<tr>
<th>SystemVerilog</th>
<th>Veryl</th>
</tr>
<tr>
<td>
<pre><code class="language-verilog">typedef enum logic[1:0] {
    MemberA,
    MemberB
} EnumA;

EnumA a;
assign a = MemberA;
</code></pre>
</td>
<td>
<pre><code class="language-veryl">enum EnumA: logic&lt;2&gt; {
    MemberA,
    MemberB
}

var a: EnumA;
assign a = EnumA::MemberA;
</code></pre>
</td>
</tr>
</table>
<h2 id="repeat-of-concatenation"><a class="header" href="#repeat-of-concatenation">ビット連結における <code>repeat</code></a></h2>
<p>ビット連結における繰り返し記述として明示的な <code>repeat</code> 記法を採用し、 複雑な <code>{}</code> の組み合わせより可読性が向上しています。</p>
<table>
<tr>
<th>SystemVerilog</th>
<th>Veryl</th>
</tr>
<tr>
<td>
<pre><code class="language-verilog">logic [31:0] a;
assign a = {{2{X[9:0]}}, {12{Y}}};
</code></pre>
</td>
<td>
<pre><code class="language-veryl">var a: logic&lt;32&gt;;
assign a = {X[9:0] repeat 2, Y repeat 12};
</code></pre>
</td>
</tr>
</table>
<h2 id="if--case-expression"><a class="header" href="#if--case-expression"><code>if</code> / <code>case</code> 式</a></h2>
<p>三項演算子の代わりに if 式と case 式を採用することで、比較するアイテム数が多い場合の可読性が向上します。</p>
<table>
<tr>
<th>SystemVerilog</th>
<th>Veryl</th>
</tr>
<tr>
<td>
<pre><code class="language-verilog">logic a;
assign a = X == 0 ? Y0 :
           X == 1 ? Y1 :
           X == 2 ? Y2 : 
                    Y3;
</code></pre>
</td>
<td>
<pre><code class="language-veryl">var a: logic;
assign a = case X {
    0      : Y0,
    1      : Y1,
    2      : Y2,
    default: Y3,
};
</code></pre>
</td>
</tr>
</table>
<h2 id="range-based-for--inside--outside"><a class="header" href="#range-based-for--inside--outside">範囲 <code>for</code> / <code>inside</code> / <code>outside</code></a></h2>
<p>閉区間 <code>..=</code> と半開区間 <code>..</code> を表す記法を導入し、 <code>for</code> 、<code>inside</code> で範囲を統一的に記述できるようにしました。また、<code>inside</code> の逆を意味する <code>outside</code> も導入しました。</p>
<table>
<tr>
<th>SystemVerilog</th>
<th>Veryl</th>
</tr>
<tr>
<td>
<pre><code class="language-verilog">for (int i = 0; i &lt; 10; i++) begin
    a[i] =   X[i] inside {[1:10]};
    b[i] = !(X[i] inside {[1:10]});
end
</code></pre>
</td>
<td>
<pre><code class="language-veryl">for i: u32 in 0..10 {
    a[i] = inside  X[i] {1..=10};
    b[i] = outside X[i] {1..=10};
}
</code></pre>
</td>
</tr>
</table>
<h2 id="msb-notation"><a class="header" href="#msb-notation"><code>msb</code> 記法</a></h2>
<p>最上位ビットを示す <code>msb</code> 記法により、パラメータから最上位ビットを計算する必要がなくなり、より意図を明確にすることができます。</p>
<table>
<tr>
<th>SystemVerilog</th>
<th>Veryl</th>
</tr>
<tr>
<td>
<pre><code class="language-verilog">logic a;
logic [WIDTH-1:0] X;
assign a = X[WIDTH-1];
</code></pre>
</td>
<td>
<pre><code class="language-veryl">var a: logic;
var X: logic&lt;WIDTH&gt;;
assign a = X[msb];
</code></pre>
</td>
</tr>
</table>
<h2 id="let-statement"><a class="header" href="#let-statement"><code>let</code> 文</a></h2>
<p>変数宣言と同時に値を束縛する専用の <code>let</code> 文が用意されており、SystemVerilogではサポートされていなかった様々な場所で使用することができます。</p>
<table>
<tr>
<th>SystemVerilog</th>
<th>Veryl</th>
</tr>
<tr>
<td>
<pre><code class="language-verilog">logic tmp;
always_ff @ (posedge i_clk) begin
    tmp = b + 1;
    x &lt;= tmp;
end
</code></pre>
</td>
<td>
<pre><code class="language-veryl">always_ff {
    let tmp: logic = b + 1;
    x = tmp;
}
</code></pre>
</td>
</tr>
</table>
<h2 id="named-block"><a class="header" href="#named-block">名前付きブロック</a></h2>
<p>変数のスコープを限定するための名前付きブロックを定義することができます。</p>
<table>
<tr>
<th>SystemVerilog</th>
<th>Veryl</th>
</tr>
<tr>
<td>
<pre><code class="language-verilog">if (1) begin: BlockA
end
</code></pre>
</td>
<td>
<pre><code class="language-veryl">:BlockA {
}
</code></pre>
</td>
</tr>
</table>
<h2 id="visibility-control"><a class="header" href="#visibility-control">可視性制御</a></h2>
<p><code>pub</code> キーワードの付かないモジュールはプロジェクト外から参照できず、ドキュメントの自動生成にも含まれません。これによりプロジェクト外に公開したいものと内部実装とを区別することができます。</p>
<table>
<tr>
<th>SystemVerilog</th>
<th>Veryl</th>
</tr>
<tr>
<td>
<pre><code class="language-verilog">module ModuleA;
endmodule

module ModuleB;
endmodule
</code></pre>
</td>
<td>
<pre><code class="language-veryl">pub module ModuleA {
}

module ModuleB {
}
</code></pre>
</td>
</tr>
</table>
<div class="footnote-definition" id="1"><sup class="footnote-definition-label">1</sup>
<p>いくつかのブラウザはデフォルトでGIF動画の再生を停止しています。ブラウザの設定を確認してください。</p>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="はじめに"><a class="header" href="#はじめに">はじめに</a></h1>
<p>Veryl を使ってみましょう。この章では Veryl のインストール、サンプルプロジェクトの作成とビルドまでを行います。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="インストール"><a class="header" href="#インストール">インストール</a></h1>
<p>Veryl バイナリをダウンロードしてインストールできます。もし Rust ユーザであれば <code>cargo</code> コマンドでインストールすることもできます。</p>
<h2 id="要件"><a class="header" href="#要件">要件</a></h2>
<p>Veryl は <code>git</code> コマンドを内部で使用します。 <code>git</code> が起動できることを確認しておいてください。</p>
<h2 id="インストール方法の選択"><a class="header" href="#インストール方法の選択">インストール方法の選択</a></h2>
<h3 id="バイナリのダウンロード"><a class="header" href="#バイナリのダウンロード">バイナリのダウンロード</a></h3>
<p><a href="https://github.com/veryl-lang/veryl/releases/latest">リリースページ</a>からダウンロードして、パスの通ったところに展開してください。</p>
<h3 id="cargo"><a class="header" href="#cargo">Cargo</a></h3>
<p><a href="https://crates.io/crates/veryl">cargo</a> コマンドからインストールすることもできます。</p>
<pre><code>cargo install veryl veryl-ls
</code></pre>
<h2 id="エディタ設定"><a class="header" href="#エディタ設定">エディタ設定</a></h2>
<p>公式には <a href="https://azure.microsoft.com/ja-jp/products/visual-studio-code">Visual Studio Code</a> と <a href="https://github.com/vim/vim">Vim</a> / <a href="https://neovim.io">Neovim</a> がサポートされています。</p>
<h3 id="visual-studio-code"><a class="header" href="#visual-studio-code">Visual Studio Code</a></h3>
<p>Visual Studio Code 向けに Veryl 拡張が提供されています。拡張はファイルタイプの検出とシンタックスハイライト、言語サーバの組み込みを提供します。拡張パネルから “Veryl” で検索するか、以下の URL からインストールしてください。</p>
<p><a href="https://marketplace.visualstudio.com/items?itemName=dalance.vscode-veryl">Veryl extension for Visual Studio Code</a></p>
<h3 id="vim--neovim"><a class="header" href="#vim--neovim">Vim / Neovim</a></h3>
<p>Vim / Neovim 向けに Veryl プラグインが提供されています。プラグインはファイルタイプの検出とシンタックスハイライトを提供します。プラグインのインストールと言語サーバの組み込みは以下の URL を参照してください。</p>
<p><a href="https://github.com/veryl-lang/veryl.vim">Vim / Neovim plugin</a></p>
<h3 id="そのほかのエディタ"><a class="header" href="#そのほかのエディタ">そのほかのエディタ</a></h3>
<p>Veryl は言語サーバを提供しているので、言語サーバをサポートしているエディタ（例えば Emacs）であれば利用できます。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="hello-world"><a class="header" href="#hello-world">Hello, World!</a></h1>
<h2 id="プロジェクトを作る"><a class="header" href="#プロジェクトを作る">プロジェクトを作る</a></h2>
<p>まず始めに、新しい Veryl プロジェクトを作りましょう。</p>
<pre><code>veryl new hello
</code></pre>
<p>コマンドを実行すると、以下のようなディレクトリとファイルが作成されます。</p>
<pre><code>$ veryl new hello
[INFO ]      Created "hello" project
$ cd hello
$ tree
.
`-- Veryl.toml

0 directories, 1 file
</code></pre>
<p><code>Veryl.toml</code> はプロジェクトの設定ファイルです。</p>
<pre><code class="language-toml">[project]
name = "hello"
version = "0.1.0"
</code></pre>
<p>全設定の説明は<a href="03_getting_started/../05_development_environment/01_project_configuration.html">こちら</a>。</p>
<h2 id="コードを書く"><a class="header" href="#コードを書く">コードを書く</a></h2>
<p>ソースコードはプロジェクトディレクトリ内のどこに書いても構いません。これは Veryl プロジェクトが独立したプロジェクトである場合もあれば、他のSystemVerilog プロジェクトに組み込まれている場合もあるからです。Veryl のソースコードの拡張子は <code>.veryl</code> です。</p>
<p>例えば以下のコードを <code>src/hello.veryl</code> に書いてみましょう。</p>
<pre><code class="language-veryl playground">module ModuleA {
    initial {
        $display("Hello, world!");
    }
}
</code></pre>
<pre><code>$ tree
.
|-- src
|   `-- hello.veryl
`-- Veryl.toml

1 directory, 2 files
</code></pre>
<blockquote>
<p>注：この本のいくつかのソースコードには、マウスをホバーすると現れるプレイボタン “▶” があります。ボタンをクリックすると、トランスパイルされた SystemVerilog のコードが現れます。<code>module ModuleA</code> のコードのボタンを押してみましょう。</p>
</blockquote>
<h2 id="ビルドする"><a class="header" href="#ビルドする">ビルドする</a></h2>
<p><code>veryl build</code> コマンドで SystemVerilog のソースコードを生成できます。</p>
<pre><code>$ veryl build
[INFO ]   Processing file ([path to hello]/src/hello.veryl)
[INFO ]       Output filelist ([path to hello]/hello.f)
$ tree
.
|-- dependencies
|-- hello.f
|-- src
|   |-- hello.sv
|   `-- hello.veryl
`-- Veryl.toml

2 directories, 4 files
</code></pre>
<p>デフォルトでは SystemVerilog のコードは Veryl のコードと同じディレクトリに生成されます。つまり <code>src/hello.sv</code> です。</p>
<pre><code class="language-verilog">module hello_ModuleA;
    initial begin
        $display("Hello, world!");
    end
endmodule
</code></pre>
<p>さらに、生成されたコードのファイルリスト <code>hello.f</code> も生成されます。これは SystemVerilog コンパイラで使用できます。<a href="https://www.veripool.org/verilator/">Verilator</a> で使用するには以下のようにします。</p>
<pre><code>$ verilator --cc -f hello.f
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="コード例"><a class="header" href="#コード例">コード例</a></h1>
<p>Veryl は SystemVerilog とほとんど同じセマンティクスを持っています。もし SystemVerilog に慣れていれば、いくつかの例をみるだけで Veryl の構文をだいたい把握できるでしょう。</p>
<p>この小さな例では、コメントに SystemVerilog 構文との違いが書かれています。</p>
<pre><code class="language-veryl playground editable">module ModuleA (
    // 識別子が先で `:` の後に型が来ます
    // ビット幅は `&lt;&gt;` で表されます
    i_data: input  logic&lt;10&gt;,
    o_data: output logic&lt;10&gt;,

    // `begin`/`end` ではなく `{}` を使います
) {
    assign o_data = i_data;
}
</code></pre>
<p>さらに、この章のコードブロックは編集することもできます。それぞれのコードを編集して実行してみましょう。</p>
<p>Veryl のソースコードは SystemVerilog と同様に、<code>module</code>、<code>interface</code>、<code>package</code> を持ちます。この章ではそれらの例を示します。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="モジュール"><a class="header" href="#モジュール">モジュール</a></h1>
<pre><code class="language-veryl playground editable">// モジュール定義
module ModuleA #(
    param ParamA: u32 = 10,
    local ParamB: u32 = 10, // 末尾カンマが可能です
) (
    i_clk : input  clock            , // `clock` はクロックのための特別な型です
    i_rst : input  reset            , // `reset` はリセットのための特別な型です
    i_sel : input  logic            ,
    i_data: input  logic&lt;ParamA&gt; [2], // `[]` は SystemVerilog のアンパック配列です
    o_data: output logic&lt;ParamA&gt;    , // `&lt;&gt;` は SystemVerilog のパック配列です
) {
    // ローカルパラメータ宣言
    //   モジュール内では `param` は使えません
    local ParamC: u32 = 10;

    // 変数宣言
    var r_data0: logic&lt;ParamA&gt;;
    var r_data1: logic&lt;ParamA&gt;;
    var r_data2: logic&lt;ParamA&gt;;

    // 値の束縛
    let _w_data2: logic&lt;ParamA&gt; = i_data;

    // リセット付き always_ff 文
    //   `always_ff` はクロック（必須）とリセット（オプション）を持ちます
    //   `if_reset` は `if (i_rst)` を意味し、リセット極性を隠蔽するための構文です
    //   `if` 文に `()` はいりません
    //   `always_ff` 内の `=` はノンブロッキング代入です
    always_ff (i_clk, i_rst) {
        if_reset {
            r_data0 = 0;
        } else if i_sel {
            r_data0 = i_data[0];
        } else {
            r_data0 = i_data[1];
        }
    }

    // リセットなし always_ff 文
    always_ff (i_clk) {
        r_data1 = r_data0;
    }

    // モジュール内にクロックとリセットが1つしかない場合
    // クロックとリセットの指定は省略できます
    always_ff {
        r_data2 = r_data1;
    }

    assign o_data = r_data1;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="インスタンス"><a class="header" href="#インスタンス">インスタンス</a></h1>
<pre><code class="language-veryl playground editable">module ModuleA #(
    param ParamA: u32 = 10,
) (
    i_clk : input  clock        ,
    i_rst : input  reset        ,
    i_data: input  logic&lt;ParamA&gt;,
    o_data: output logic&lt;ParamA&gt;,
) {
    var r_data1: logic&lt;ParamA&gt;;
    var r_data2: logic&lt;ParamA&gt;;

    assign r_data1 = i_data + 1;
    assign o_data  = r_data2 + 2;

    // インスタンス宣言
    //   インスタンス宣言は `inst` キーワードではじまります
    //   ポート接続は `()` 内で指定します
    //   各ポートの接続は `[port_name]:[variable]` のような形式になります
    //   `[port_name]` は `[port_name]:[port_name]` を意味します
    inst u_module_b: ModuleB (
        i_clk          ,
        i_data: r_data1,
        o_data: r_data2,
    );

    // パラメータオーバーライド付きインスタンス宣言
    //   パラメータの接続記法はポートと同様です
    inst u_module_c: ModuleC #(ParamA, ParamB: 10,);
}

module ModuleB #(
    param ParamA: u32 = 10,
) (
    i_clk : input  clock        ,
    i_data: input  logic&lt;ParamA&gt;,
    o_data: output logic&lt;ParamA&gt;,
) {
    assign o_data = 1;
}

module ModuleC #(
    param ParamA: u32 = 10,
    param ParamB: u32 = 10,
) () {}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="インターフェース"><a class="header" href="#インターフェース">インターフェース</a></h1>
<pre><code class="language-veryl playground editable">// インターフェース定義
interface InterfaceA #(
    param ParamA: u32 = 1,
    param ParamB: u32 = 1,
) {
    local ParamC: u32 = 1;

    var a: logic&lt;ParamA&gt;;
    var b: logic&lt;ParamA&gt;;
    var c: logic&lt;ParamA&gt;;

    // modport 定義
    modport master {
        a: input ,
        b: input ,
        c: output,
    }

    modport slave {
        a: input ,
        b: input ,
        c: output,
    }
}

module ModuleA (
    i_clk: input clock,
    i_rst: input reset,
    // modport によるポート宣言
    intf_a_mst: modport InterfaceA::master,
    intf_a_slv: modport InterfaceA::slave ,
) {
    // インターフェースのインスタンス
    inst u_intf_a: InterfaceA [10];
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="パッケージ"><a class="header" href="#パッケージ">パッケージ</a></h1>
<pre><code class="language-veryl playground editable">// パッケージ定義
package PackageA {
    local ParamA: u32 = 1;
    local ParamB: u32 = 1;

    function FuncA (
        a: input logic&lt;ParamA&gt;,
    ) -&gt; logic&lt;ParamA&gt; {
        return a + 1;
    }
}

module ModuleA {
    let a : logic&lt;10&gt; = PackageA::ParamA;
    let _b: logic&lt;10&gt; = PackageA::FuncA(a);
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="言語リファレンス"><a class="header" href="#言語リファレンス">言語リファレンス</a></h1>
<p>この章では Veryl の言語仕様について説明します。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ソースコードの構造"><a class="header" href="#ソースコードの構造">ソースコードの構造</a></h1>
<p>Veryl のソースコードはいくつかの <code>module</code>、<code>interface</code>、<code>package</code> からなります。</p>
<pre><code class="language-veryl playground">module ModuleA {}

module ModuleB {}

interface InterfaceA {}

package PackageA {}
</code></pre>
<p>トランスパイルされたコードにおける <code>module</code>、<code>interface</code>、<code>package</code> の名前には先頭にプロジェクト名が付きます。このサンプルコードでは <code>project_</code> が付きます。これはプロジェクト間で名前が衝突するのを防ぐためです。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="字句構造"><a class="header" href="#字句構造">字句構造</a></h1>
<p>この章では Veryl の字句構造について説明します。まず始めに、全体的なことがらからです。</p>
<h2 id="エンコーディング"><a class="header" href="#エンコーディング">エンコーディング</a></h2>
<p>Veryl のソースコードは UTF-8 エンコーディングでなければなりません。</p>
<h2 id="空白"><a class="header" href="#空白">空白</a></h2>
<p><code> </code>（空白）、<code>\t</code>、<code>\n</code> は空白として扱われ、Veryl のパーサはこれらを全て無視します。</p>
<h2 id="コメント"><a class="header" href="#コメント">コメント</a></h2>
<p>行コメントと複数行コメントが使えます。ほとんどのコメントはトランスパイルされたコードにも出力されます。</p>
<pre><code class="language-veryl playground">// 行コメント

/*
複数

行

コメント
*/

</code></pre>
<h3 id="ドキュメンテーションコメント"><a class="header" href="#ドキュメンテーションコメント">ドキュメンテーションコメント</a></h3>
<p><code>///</code> ではじまる行コメントはドキュメンテーションコメントとして扱われます。ドキュメンテーションコメントはドキュメントの生成に使われます。</p>
<pre><code class="language-veryl playground">/// ドキュメンテーションコメント

</code></pre>
<h2 id="識別子"><a class="header" href="#識別子">識別子</a></h2>
<p>識別子は ASCII のアルファベットと数値、 <code>_</code> からなります。先頭が数値であってはなりません。正式な定義は以下の正規表現です。</p>
<pre><code>[a-zA-Z_][a-zA-Z0-9_]*
</code></pre>
<h2 id="文字列"><a class="header" href="#文字列">文字列</a></h2>
<p><code>"</code> で囲んだものが文字列になります。<code>\"</code> や <code>\n</code> のように <code>\</code> によるエスケープも可能です。</p>
<pre><code>"Hello, World!"
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="演算子"><a class="header" href="#演算子">演算子</a></h1>
<p>ほとんどの演算子は SystemVerilog と同じです。いくつか違いがあるので注意してください。</p>
<ul>
<li><code>&lt;:</code> 小なり演算子です。SystemVerilog の <code>&lt;</code> と同じです。</li>
<li><code>&gt;:</code> 大なり演算子です。SystemVerilog の <code>&gt;</code> と同じです。</li>
</ul>
<pre><code class="language-veryl">// 単項算術演算
a = +1;
a = -1;

// 単項論理演算
a = !1;
a = ~1;

// 単項集約演算
a = &amp;1;
a = |1;
a = ^1;
a = ~&amp;1;
a = ~|1;
a = ~^1;
a = ^~1;

// 二項算術演算
a = 1 ** 1;
a = 1 * 1;
a = 1 / 1;
a = 1 % 1;
a = 1 + 1;
a = 1 - 1;

// シフト演算
a = 1 &lt;&lt; 1;
a = 1 &gt;&gt; 1;
a = 1 &lt;&lt;&lt; 1;
a = 1 &gt;&gt;&gt; 1;

// 比較演算
a = 1 &lt;: 1;
a = 1 &lt;= 1;
a = 1 &gt;: 1;
a = 1 &gt;= 1;
a = 1 == 1;
a = 1 != 1;
a = 1 === 1;
a = 1 !== 1;
a = 1 ==? 1;
a = 1 !=? 1;

// ビット演算
a = 1 &amp; 1;
a = 1 ^ 1;
a = 1 ~^ 1;
a = 1 ^~ 1;
a = 1 | 1;

// 二項論理演算
a = 1 &amp;&amp; 1;
a = 1 || 1;
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="数値"><a class="header" href="#数値">数値</a></h1>
<h2 id="整数"><a class="header" href="#整数">整数</a></h2>
<pre><code class="language-veryl">// 整数
0123456789
01_23_45_67_89

// 2進数
32'b01xzXZ
32'b01_xz_XZ

// 8進数
32'o01234567xzXZ
32'o01_23_45_67_xz_XZ

// 10進数
32'd0123456789
32'd01_23_45_67_89

// 16進数
128'h0123456789abcdefxzABCDEFXZ
128'h01_23_45_67_89_ab_cd_ef_xz_AB_CD_EF_XZ
</code></pre>
<h2 id="全ビットのセット"><a class="header" href="#全ビットのセット">全ビットのセット</a></h2>
<pre><code class="language-veryl">// 全て 0
'0

// 全て 1
'1

// 全て x
'x
'X

// 全て z
'z
'Z
</code></pre>
<h2 id="幅なし整数"><a class="header" href="#幅なし整数">幅なし整数</a></h2>
<p>ビット幅指定は省略することができます。省略された場合、トランスパイルされたコードでは適切なビット幅が付与されます。</p>
<pre><code class="language-veryl playground">module ModuleA {
    local a0: u64 = 'b0101;
    local a1: u64 = 'o01234567;
    local a2: u64 = 'd0123456789;
    local a3: u64 = 'h0123456789fffff;
}
</code></pre>
<h2 id="指定ビットのセット"><a class="header" href="#指定ビットのセット">指定ビットのセット</a></h2>
<p>“全ビットのセット” にビット幅指定を付与することもできます。</p>
<pre><code class="language-veryl playground">module ModuleA {
    local a0: u64 = 1'0;
    local a1: u64 = 2'1;
    local a2: u64 = 3'x;
    local a3: u64 = 4'z;
}
</code></pre>
<h2 id="浮動小数点数"><a class="header" href="#浮動小数点数">浮動小数点数</a></h2>
<pre><code class="language-veryl">// 浮動小数点数
0123456789.0123456789
01_23_45_67_89.01_23_45_67_89

// 指数表記
0123456789.0123456789e+0123456789
01_23_45_67_89.01_23_45_67_89E-01_23_45_67_89
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="配列リテラル"><a class="header" href="#配列リテラル">配列リテラル</a></h1>
<p><code>'{}</code> は配列リテラルを表します。リテラル内には式、<code>repeat</code> キーワード、<code>default</code> キーワードを配置することができます。</p>
<pre><code class="language-veryl playground">module ModuleA {
    let _a: logic [3] = '{1, 2, 3};
    let _b: logic [3] = '{1 repeat 3}; // '{1, 1, 1}
    let _c: logic [3] = '{default: 3}; // '{3, 3, 3}
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="データ型"><a class="header" href="#データ型">データ型</a></h1>
<p>この章ではデータ型について説明します。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="組み込み型"><a class="header" href="#組み込み型">組み込み型</a></h1>
<h2 id="幅指定可能な4値データ型"><a class="header" href="#幅指定可能な4値データ型">幅指定可能な4値データ型</a></h2>
<p><code>logic</code> は4値（<code>0</code>、<code>1</code>、<code>x</code>、<code>z</code>）のデータ型です。幅は <code>logic</code> のあとの <code>&lt;&gt;</code> で指定できます。<code>&lt;X, Y, Z,,,&gt;</code> のように多次元指定も可能です。</p>
<pre><code class="language-veryl playground">module ModuleA {
    let _a: logic         = 1;
    let _b: logic&lt;10&gt;     = 1;
    let _c: logic&lt;10, 10&gt; = 1;
}
</code></pre>
<h2 id="幅指定可能な2値データ型"><a class="header" href="#幅指定可能な2値データ型">幅指定可能な2値データ型</a></h2>
<p><code>bit</code> は2値（<code>0</code>、<code>1</code>）のデータ型です。幅は <code>logic</code> のあとの <code>&lt;&gt;</code> で指定できます。<code>&lt;X, Y, Z,,,&gt;</code> のように多次元指定も可能です。</p>
<pre><code class="language-veryl playground">module ModuleA {
    let _a: bit         = 1;
    let _b: bit&lt;10&gt;     = 1;
    let _c: bit&lt;10, 10&gt; = 1;
}
</code></pre>
<h2 id="整数型"><a class="header" href="#整数型">整数型</a></h2>
<p>整数型にはいくつかの種類があります。</p>
<ul>
<li><code>u32</code>：32ビットの符号なし整数</li>
<li><code>u64</code>：64ビットの符号なし整数</li>
<li><code>i32</code>：32ビットの符号付き整数</li>
<li><code>i64</code>：64ビットの符号付き整数</li>
</ul>
<pre><code class="language-veryl playground">module ModuleA {
    let _a: u32 = 1;
    let _b: u64 = 1;
    let _c: i32 = 1;
    let _d: i64 = 1;
}
</code></pre>
<h2 id="浮動小数点数型"><a class="header" href="#浮動小数点数型">浮動小数点数型</a></h2>
<p>浮動小数点数型にもいくつかの種類があります。</p>
<ul>
<li><code>f32</code>：32ビット浮動小数点数</li>
<li><code>f64</code>：64ビット浮動小数点数</li>
</ul>
<p>いずれも IEEE Std 754 準拠の表現です。</p>
<pre><code class="language-veryl playground">module ModuleA {
    let _a: f32 = 1.0;
    let _b: f64 = 1.0;
}
</code></pre>
<h2 id="文字列型"><a class="header" href="#文字列型">文字列型</a></h2>
<p><code>string</code> は文字列を表す型です。</p>
<pre><code class="language-veryl playground">module ModuleA {
    let _a: string = "";
}
</code></pre>
<h2 id="type型"><a class="header" href="#type型">Type型</a></h2>
<p><code>type</code> は型の種類を表す型です。<code>type</code> 型の変数は <code>param</code> か <code>local</code> としてのみ定義可能です。</p>
<pre><code class="language-veryl playground">module ModuleA {
    local a: type = logic;
    local b: type = logic&lt;10&gt;;
    local c: type = u32;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ユーザ定義型"><a class="header" href="#ユーザ定義型">ユーザ定義型</a></h1>
<h2 id="構造体"><a class="header" href="#構造体">構造体</a></h2>
<p><code>struct</code> は複合データ型です。いくつかのフィールドを持つことができ、<code>.</code> 演算子を通してアクセスできます。</p>
<pre><code class="language-veryl playground">module ModuleA {
    struct StructA {
        member_a: logic    ,
        member_b: logic&lt;10&gt;,
        member_c: u32      ,
    }

    var a: StructA;

    assign a.member_a = 0;
    assign a.member_b = 1;
    assign a.member_c = 2;
}
</code></pre>
<h2 id="列挙型"><a class="header" href="#列挙型">列挙型</a></h2>
<p><code>enum</code> は列挙型です。名前の付いたバリアントを複数持ち、<code>enum</code> 型の変数にはそのバリアントのうち1つだけをセットできます。バリアント名は <code>[enum name]::[variant name]</code> の形式で指定可能です。それぞれのバリアントは対応する整数値を持ち、<code>=</code> で指定することができます。指定されなかった場合は自動的に割り当てられます。</p>
<pre><code class="language-veryl playground">module A {
    enum EnumA: logic&lt;2&gt; {
        member_a,
        member_b,
        member_c = 3,
    }

    var a: EnumA;

    assign a = EnumA::member_a;
}
</code></pre>
<h2 id="ユニオン"><a class="header" href="#ユニオン">ユニオン</a></h2>
<p><code>union</code> はパックされたタグなしの直和型で、SystemVerilog では <code>packed union</code> にトランスパイルされます。ユニオンのそれぞれのバリアントの幅は同じでなければなりません。</p>
<pre><code class="language-veryl playground">module A {
    union UnionA {
        variant_a: logic&lt;8&gt;      ,
        variant_b: logic&lt;2, 4&gt;   ,
        variant_c: logic&lt;4, 2&gt;   ,
        variant_d: logic&lt;2, 2, 2&gt;,
    }
    var a          : UnionA;
    assign a.variant_a = 8'haa;
}
</code></pre>
<h2 id="型定義"><a class="header" href="#型定義">型定義</a></h2>
<p><code>type</code> キーワードを使って、スカラー型や配列型への型エイリアスを定義することができます。</p>
<pre><code class="language-veryl playground">module A {
    type word_t    = logic &lt;16&gt;     ;
    type regfile_t = word_t     [16];
    type octbyte   = bit   &lt;8&gt;  [8] ;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="配列"><a class="header" href="#配列">配列</a></h1>
<p>任意のデータ型に対して <code>[]</code> と付与することで配列を定義することができます。配列の長さは <code>[]</code> 内の値で指定します。</p>
<pre><code class="language-veryl playground">module ModuleA {
    struct StructA {
        A: logic,
    }
    enum EnumA: logic {
        A,
    }

    var a: logic       [20];
    var b: logic  &lt;10&gt; [20];
    var c: u32         [20];
    var d: StructA     [20];
    var e: EnumA       [20];

    assign a[0] = 0;
    assign b[0] = 0;
    assign c[0] = 0;
    assign d[0] = 0;
    assign e[0] = 0;
}
</code></pre>
<p><code>[X, Y, Z,,,]</code> のように多次元配列も定義できます。</p>
<pre><code class="language-veryl playground">module ModuleA {
    struct StructA {
        A: logic,
    }
    enum EnumA: logic {
        A,
    }

    var a: logic       [10, 20, 30];
    var b: logic  &lt;10&gt; [10, 20, 30];
    var c: u32         [10, 20, 30];
    var d: StructA     [10, 20, 30];
    var e: EnumA       [10, 20, 30];

    assign a[0][0][0] = 0;
    assign b[0][0][0] = 0;
    assign c[0][0][0] = 0;
    assign d[0][0][0] = 0;
    assign e[0][0][0] = 0;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="クロックとリセット"><a class="header" href="#クロックとリセット">クロックとリセット</a></h1>
<p><code>clock</code> はクロック配線を表す特別な型です。クロックの極性を指定するため以下の3種類があります。</p>
<ul>
<li><code>clock</code>: ビルド時の設定で指定される極性を持つクロック型</li>
<li><code>clock_posedge</code>: 正極性のクロック型</li>
<li><code>clock_negedge</code>: 負極性のクロック型</li>
</ul>
<p><code>reset</code> はリセット配線を表す特別な型です。リセットの極性と同期・非同期を指定するため以下の5種類があります。</p>
<ul>
<li><code>reset</code>: ビルド時の設定で指定される極性と同期性を持つリセット型</li>
<li><code>reset_async_high</code>: 正極性の非同期リセット型</li>
<li><code>reset_async_low</code>: 負極性の非同期リセット型</li>
<li><code>reset_sync_high</code>: 正極性の同期リセット型</li>
<li><code>reset_sync_low</code>: 負極性の同期リセット型</li>
</ul>
<p>特別な要件がなければ、コードの再利用を高めるため <code>clock</code> と <code>reset</code> の使用を推奨します。</p>
<pre><code class="language-veryl playground">module ModuleA (
    i_clk    : input clock           ,
    i_clk_p  : input clock_posedge   ,
    i_clk_n  : input clock_negedge   ,
    i_rst    : input reset           ,
    i_rst_a  : input reset_async_high,
    i_rst_a_n: input reset_async_low ,
    i_rst_s  : input reset_sync_high ,
    i_rst_s_n: input reset_sync_low  ,
) {
    var a: logic;
    var b: logic;
    var c: logic;

    always_ff (i_clk, i_rst) {
        if_reset {
            a = 0;
        } else {
            a = 1;
        }
    }

    always_ff (i_clk_p, i_rst_a) {
        if_reset {
            b = 0;
        } else {
            b = 1;
        }
    }

    always_ff (i_clk_n, i_rst_s_n) {
        if_reset {
            c = 0;
        } else {
            c = 1;
        }
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="式"><a class="header" href="#式">式</a></h1>
<p>この章では式について説明します。式は変数や演算子、関数呼び出しなどを組み合わせたもので、評価して値を得ることができます。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="演算子の優先順位"><a class="header" href="#演算子の優先順位">演算子の優先順位</a></h1>
<p>式内での演算子の優先順位は SystemVerilog とほとんど同じです。</p>
<div class="table-wrapper"><table><thead><tr><th>演算子</th><th>結合性</th><th>優先順位</th></tr></thead><tbody>
<tr><td><code>()</code> <code>[]</code> <code>::</code> <code>.</code></td><td>左</td><td>高い</td></tr>
<tr><td><code>+</code> <code>-</code> <code>!</code> <code>~</code> <code>&amp;</code> <code>~&amp;</code> <code>|</code> <code>~|</code></td><td></td><td></td></tr>
<tr><td><code>^</code> <code>~^</code> <code>^~</code> (単項)</td><td>左</td><td></td></tr>
<tr><td><code>**</code></td><td>左</td><td></td></tr>
<tr><td><code>*</code> <code>/</code> <code>%</code></td><td>左</td><td></td></tr>
<tr><td><code>+</code> <code>-</code> (二項)</td><td>左</td><td></td></tr>
<tr><td><code>&lt;&lt;</code> <code>&gt;&gt;</code> <code>&lt;&lt;&lt;</code> <code>&gt;&gt;&gt;</code></td><td>左</td><td></td></tr>
<tr><td><code>&lt;:</code> <code>&lt;=</code> <code>&gt;:</code> <code>&gt;=</code></td><td>左</td><td></td></tr>
<tr><td><code>==</code> <code>!=</code> <code>===</code> <code>!==</code> <code>==?</code> <code>!=?</code></td><td>左</td><td></td></tr>
<tr><td><code>&amp;</code> (二項)</td><td>左</td><td></td></tr>
<tr><td><code>^</code> <code>~^</code> <code>^~</code> (二項)</td><td>左</td><td></td></tr>
<tr><td><code>|</code>(二項)</td><td>左</td><td></td></tr>
<tr><td><code>&amp;&amp;</code></td><td>左</td><td></td></tr>
<tr><td><code>||</code></td><td>左</td><td></td></tr>
<tr><td><code>=</code> <code>+=</code> <code>-=</code> <code>*=</code> <code>/=</code> <code>%=</code> <code>&amp;=</code> <code>^=</code> <code>|=</code> <br></td><td></td><td></td></tr>
<tr><td><code>&lt;&lt;=</code> <code>&gt;&gt;=</code> <code>&lt;&lt;&lt;=</code> <code>&gt;&gt;&gt;=</code></td><td>なし</td><td></td></tr>
<tr><td><code>{}</code></td><td>なし</td><td>低い</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="関数呼び出し"><a class="header" href="#関数呼び出し">関数呼び出し</a></h1>
<p>関数は <code>function_name(argument)</code> の形式で呼び出すことができます。<code>$clog2</code> のような SystemVerilog のシステム関数も使えます。</p>
<pre><code class="language-veryl playground">module ModuleA {
    let _a: logic = PackageA::FunctionA(1, 1);
    let _b: logic = $clog2(1, 1);
}

package PackageA {
    function FunctionA (
        a: input logic,
        b: input logic,
    ) {}
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="連結"><a class="header" href="#連結">連結</a></h1>
<p><code>{}</code> はビット連結を表します。<code>{}</code> の中では <code>repeat</code> キーワードを使うことで指定されたオペランドを繰り返すこともできます。</p>
<pre><code class="language-veryl playground">module ModuleA {
    let a : logic&lt;10&gt; = 1;
    let b : logic&lt;10&gt; = 1;
    let _c: logic     = {a[9:0], b[4:3]};
    let _d: logic     = {a[9:0] repeat 10, b repeat 4};
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="if"><a class="header" href="#if">if</a></h1>
<p><code>if</code> を用いた条件式を使えます。<code>if</code> キーワードの後に条件を示す節を置きますが、<code>()</code> で囲む必要はありません。if 式は常になんらかの値に評価される必要があるため <code>else</code> は必須です。</p>
<pre><code class="language-veryl playground">module ModuleA {
    let a: logic&lt;10&gt; = 1;
    var b: logic&lt;10&gt;;

    assign b = if a == 0 {
        1
    } else if a &gt;: 1 {
        2
    } else {
        3
    };
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="case"><a class="header" href="#case">case</a></h1>
<p>もう一つの条件式が <code>case</code> です。<code>case</code> は <code>式: 式</code> という形式の条件を複数持ちます。もし <code>case</code> キーワードの後の式と条件の左側の式が一致すれば、その条件の右側の式が返されます。<code>default</code> はそれ以外の条件が全て失敗したときに返される特別な条件です。case 式は常になんらかの値に評価される必要があるため <code>default</code> は必須です。</p>
<pre><code class="language-veryl playground">module ModuleA {
    let a: logic&lt;10&gt; = 1;
    var b: logic&lt;10&gt;;
    let c: logic&lt;10&gt; = 1;

    assign b = case a {
        0      : 1,
        1      : 2,
        c - 1  : 4,
        default: 5,
    };
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ビット選択"><a class="header" href="#ビット選択">ビット選択</a></h1>
<p><code>[]</code> はビット選択演算子です。<code>[]</code> に式を指定すれば1ビットを選択できます。範囲選択する場合は <code>[式:式]</code> とします。</p>
<pre><code class="language-veryl playground">module ModuleA {
    let a: logic&lt;10&gt; = 1;
    var b: logic&lt;10&gt;;
    var c: logic&lt;10&gt;;

    assign b = a[3];
    assign c = a[4:0];
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="範囲"><a class="header" href="#範囲">範囲</a></h1>
<p>範囲は範囲演算子で指定できます。範囲演算子には以下の2種類があります。</p>
<ul>
<li><code>..</code>：半開区間</li>
<li><code>..=</code>：閉区間</li>
</ul>
<p>範囲は <code>for</code> 文などの場所で使うことができます。</p>
<pre><code class="language-veryl playground">module ModuleA {
    initial {
        for _i: u32 in 0..10 {}

        for _j: u32 in 0..=10 {}
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="msb--lsb"><a class="header" href="#msb--lsb">msb / lsb</a></h1>
<p><code>msb</code> と <code>lsb</code> は <code>[]</code> によるビット選択で使用できます。<code>msb</code> はオペランドの最上位ビットを意味します。<code>lsb</code> はオペランドの最下位ビットを意味し、0と同じです。</p>
<pre><code class="language-veryl playground">module ModuleA {
    let a : logic&lt;10&gt; = 1;
    let _b: logic&lt;10&gt; = a[msb - 3:lsb];
    let _c: logic&lt;10&gt; = a[msb - 1:lsb + 1];
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="inside--outside"><a class="header" href="#inside--outside">inside / outside</a></h1>
<p><code>inside</code> は 指定された式が <code>{}</code> で与えられた条件内にあるかどうかを調べます。条件は単一の式または<a href="05_language_reference/04_expression/./07_range.html">範囲</a>を指定できます。条件を満たすとき <code>inside</code> は <code>1</code> を、そうでなければ <code>0</code> を返します。<code>outside</code> はその逆です。</p>
<pre><code class="language-veryl playground">module ModuleA {
    var a: logic;
    var b: logic;

    assign a = inside 1 + 2 / 3 {0, 0..10, 1..=10};
    assign b = outside 1 * 2 - 1 {0, 0..10, 1..=10};
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="文"><a class="header" href="#文">文</a></h1>
<p>この章では文について説明します。文は <code>always_ff</code> や <code>always_comb</code> などいくつかの宣言で使用することができます。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="代入"><a class="header" href="#代入">代入</a></h1>
<p>代入文は <code>変数 = 式;</code> の形式です。SystemVerilog と異なり、<code>always_comb</code> でも <code>always_ff</code> でも代入演算子は <code>=</code> です。以下のような代入演算子もあります。</p>
<ul>
<li><code>+=</code>：加算代入</li>
<li><code>-=</code>：減算代入</li>
<li><code>*=</code>：乗算代入</li>
<li><code>/=</code>：除算代入</li>
<li><code>%=</code>：剰余代入</li>
<li><code>&amp;=</code>：ビットAND代入</li>
<li><code>|=</code>：ビットOR代入</li>
<li><code>^=</code>：ビットXOR代入</li>
<li><code>&lt;&lt;=</code>：論理左シフト代入</li>
<li><code>&gt;&gt;=</code>：論理右シフト代入</li>
<li><code>&lt;&lt;&lt;=</code>：算術左シフト代入</li>
<li><code>&gt;&gt;&gt;=</code>：算術右シフト代入</li>
</ul>
<pre><code class="language-veryl playground">module ModuleA (
    i_clk: input clock,
) {
    let a: logic&lt;10&gt; = 1;
    var b: logic&lt;10&gt;;
    var c: logic&lt;10&gt;;
    var d: logic&lt;10&gt;;
    var e: logic&lt;10&gt;;

    always_comb {
        b =  a + 1;
        c += a + 1;
    }

    always_ff (i_clk) {
        d =  a + 1;
        e -= a + 1;
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="関数呼び出し-1"><a class="header" href="#関数呼び出し-1">関数呼び出し</a></h1>
<p>関数呼び出しは文として使うこともできます。この場合、関数の戻り値は無視されます。</p>
<pre><code class="language-veryl playground">module ModuleA {
    initial {
        $display("Hello, world!");
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="if-1"><a class="header" href="#if-1">if</a></h1>
<p><code>if</code> は文として使うこともできます。<code>if</code> 式との違いは <code>{}</code> 内に文を書くことです。</p>
<pre><code class="language-veryl playground">module ModuleA {
    let a: logic&lt;10&gt; = 1;
    var b: logic&lt;10&gt;;

    always_comb {
        if a == 0 {
            b = 1;
        } else if a &gt;: 1 {
            b = 2;
        } else {
            b = 3;
        }
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="case-1"><a class="header" href="#case-1">case</a></h1>
<p><code>case</code> は文として使うこともできます。条件の右側は文になります。</p>
<pre><code class="language-veryl playground">module ModuleA {
    let a: logic&lt;10&gt; = 1;
    var b: logic&lt;10&gt;;

    always_comb {
        case a {
            0: b = 1;
            1: b = 2;
            2: {
                   b = 3;
                   b = 3;
                   b = 3;
               }
            default: b = 4;
        }
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="for"><a class="header" href="#for">for</a></h1>
<p><code>for</code> 文は繰り返しを表します。<code>in</code> キーワードの前にループ変数を、後に<a href="05_language_reference/05_statement/../04_expression/07_range.html">範囲</a>を書きます。</p>
<p><code>break</code> を使ってループを中断することもできます。</p>
<pre><code class="language-veryl playground">module ModuleA {
    var a: logic&lt;10&gt;;

    always_comb {
        for i: u32 in 0..10 {
            a += i;

            if i == 5 {
                break;
            }
        }
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="return"><a class="header" href="#return">return</a></h1>
<p><code>return</code> 文は関数からの戻りを示します。<code>return</code> キーワードの後の式は関数の戻り値です。</p>
<pre><code class="language-veryl playground">module ModuleA {
    function FunctionA () -&gt; u32 {
        return 0;
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="let"><a class="header" href="#let">let</a></h1>
<p><code>let</code> 文はある名前に値を束縛します。これは <code>always_ff</code> 、 <code>always_comb</code> および関数宣言の中で使うことができます。</p>
<p><code>let</code> 文はブロック中のどこにでも置くことができます。</p>
<pre><code class="language-veryl playground">module ModuleA (
    i_clk: input clock,
) {
    var a: logic;
    var b: logic;
    var c: logic;

    always_ff (i_clk) {
        let x: logic = 1;
        a = x + 1;
    }

    always_comb {
        let y: logic = 1;
        b = y + 1;

        let z: logic = 1;
        c = z + 1;
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="宣言"><a class="header" href="#宣言">宣言</a></h1>
<p>この章では宣言について説明します。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="変数"><a class="header" href="#変数">変数</a></h1>
<p>変数宣言は <code>var</code> キーワードで始まり、変数名、<code>:</code>、変数の型と続きます。</p>
<p>未使用の変数は警告が発生します。<code>_</code> で始まる変数名は未使用変数を意味し、警告を抑制します。</p>
<p>宣言時に名前に値を束縛する場合は <code>var</code> の代わりに <code>let</code> を使います。</p>
<pre><code class="language-veryl playground">module ModuleA {
    var _a: logic        ;
    var _b: logic&lt;10&gt;    ;
    var _c: logic&lt;10, 10&gt;;
    var _d: u32          ;
    let _e: logic         = 1;

    assign _a = 1;
    assign _b = 1;
    assign _c = 1;
    assign _d = 1;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="パラメータ"><a class="header" href="#パラメータ">パラメータ</a></h1>
<p>パラメータは変数と同時に宣言できます。<code>param</code> キーワードはモジュールヘッダで使用することができ、インスタンス時に上書きできます。<code>local</code> キーワードはモジュール内で使用することができ、上書きできません。</p>
<pre><code class="language-veryl playground">module ModuleA #(
    param ParamA: u32 = 1,
) {
    local ParamB: u32 = 1;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="レジスタ"><a class="header" href="#レジスタ">レジスタ</a></h1>
<p>レジスタ変数とは <code>always_ff</code> で代入される変数です。合成フェーズでフリップフロップにマップされます。</p>
<p><code>always_ff</code> は必須のクロック変数、オプションのリセット変数、<code>{}</code> ブロックをとります。クロックとリセットは <code>()</code> に書きます。指定されたクロックとリセットは <code>clock</code> / <code>reset</code> 型を持ち、そのビット幅は1ビットでなければなりません。</p>
<p><code>if_reset</code> は <code>always_ff</code> に書ける特別なキーワードで、そのレジスタ変数のリセット条件を示します。<code>if_reset</code> を使う場合は <code>always_ff</code> のリセット変数は必須です。これを使うことで、リセットの極性と同期性を隠ぺいすることができます。実際の極性と同期性は <code>Veryl.toml</code> の <code>[build]</code> セクションで設定できます。</p>
<p>モジュール内にクロックとリセットが1つしかない場合、クロックとリセットの指定は省略できます。</p>
<pre><code class="language-veryl playground">module ModuleA (
    i_clk: input clock,
    i_rst: input reset,
) {
    var a: logic&lt;10&gt;;
    var b: logic&lt;10&gt;;
    var c: logic&lt;10&gt;;

    always_ff (i_clk) {
        a = 1;
    }

    always_ff (i_clk, i_rst) {
        if_reset {
            b = 0;
        } else {
            b = 1;
        }
    }

    always_ff {
        if_reset {
            c = 0;
        } else {
            c = 1;
        }
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="組み合わせ回路"><a class="header" href="#組み合わせ回路">組み合わせ回路</a></h1>
<p><code>always_comb</code> で代入される変数は組み合わせ回路を意味します。</p>
<pre><code class="language-veryl playground">module ModuleA {
    let a: logic&lt;10&gt; = 1;
    var b: logic&lt;10&gt;;

    always_comb {
        b = a + 1;
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="assign"><a class="header" href="#assign">assign</a></h1>
<p><code>assign</code> 宣言で変数に式を代入することができます。</p>
<pre><code class="language-veryl playground">module ModuleA {
    var a: logic&lt;10&gt;;

    assign a = 1;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="関数"><a class="header" href="#関数">関数</a></h1>
<p>関数は <code>function</code> キーワードで宣言できます。引数は <code>()</code> 内に書き、戻り値の型を <code>-&gt;</code> の後に書きます。</p>
<p>関数が戻り値を持たない場合、<code>-&gt;</code> は省略できます。</p>
<pre><code class="language-veryl playground">module ModuleA {
    let a: logic&lt;10&gt; = 1;
    var b: logic&lt;10&gt;;

    function FunctionA (
        a: input logic&lt;10&gt;,
    ) -&gt; logic&lt;10&gt; {
        return a + 1;
    }

    function FunctionB (
        a: input logic&lt;10&gt;,
    ) {}

    assign b = FunctionA(a);

    initial {
        FunctionB(a);
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="initial--final"><a class="header" href="#initial--final">initial / final</a></h1>
<p><code>initial</code> ブロック内の文はシミュレーション開始時に実行され、<code>final</code> は終了時です。どちらも論理合成では無視され、デバッグやアサーションに使うことができます。</p>
<pre><code class="language-veryl playground">module ModuleA {
    initial {
        $display("initial");
    }

    final {
        $display("final");
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="アトリビュート"><a class="header" href="#アトリビュート">アトリビュート</a></h1>
<p>アトリビュートは変数宣言などいくつかの宣言に注釈を付けることができます。</p>
<h2 id="sv-アトリビュート"><a class="header" href="#sv-アトリビュート">SV アトリビュート</a></h2>
<p>SV アトリビュートは SystemVerilog のアトリビュートを表し、<code>(*  *)</code> という形式の SystemVerilog アトリビュートに変換されます。</p>
<pre><code class="language-veryl playground">module ModuleA {
    #[sv("ram_style=\"block\"")]
    let _a: logic&lt;10&gt; = 1;
    #[sv("mark_debug=\"true\"")]
    let _b: logic&lt;10&gt; = 1;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="生成"><a class="header" href="#生成">生成</a></h1>
<p>宣言や <code>for</code> や <code>if</code> を使って生成することができます。<code>:</code> で示すラベルは生成された複数の宣言を識別するのに必要です。</p>
<pre><code class="language-veryl playground">module ModuleA {
    var a: logic&lt;10&gt;;

    for i in 0..10 :label {
        if i &gt;: 5 :label {
            assign a[i] = i + 2;
        } else { // else 句のラベルは省略可能
            assign a[i] = i + 2;
        }
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="インスタンス-1"><a class="header" href="#インスタンス-1">インスタンス</a></h1>
<p><code>inst</code> キーワードはモジュールやインターフェースのインスタンス化を表します。インスタンスの名前は <code>inst</code> の後に、インスタンスの型は <code>:</code> の後に書きます。<code>#()</code> でパラメータオーバーライドを、<code>()</code> でポート接続を表します。</p>
<pre><code class="language-veryl playground">module ModuleA #(
    param paramA: u32 = 1,
) {
    let a: logic&lt;10&gt; = 1;
    let b: logic&lt;10&gt; = 1;

    inst instB: ModuleB #(
        paramA    , // 名前によるパラメータ代入
        paramB: 10,
    ) (
        a    , // 名前によるポート接続
        bb: b,
    );
}

module ModuleB #(
    param paramA: u32 = 1,
    param paramB: u32 = 1,
) (
    a : input logic&lt;10&gt;,
    bb: input logic&lt;10&gt;,
) {}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="名前付きブロック"><a class="header" href="#名前付きブロック">名前付きブロック</a></h1>
<p><code>{}</code> ブロックにラベルを付けることができます。そのような名前付きブロックは独立した名前空間を持ちます。</p>
<pre><code class="language-veryl playground">module ModuleA {
    :labelA {
        let _a: logic&lt;10&gt; = 1;
    }

    :labelB {
        let _a: logic&lt;10&gt; = 1;
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="import--export"><a class="header" href="#import--export">Import / Export</a></h1>
<p><code>import</code> 宣言は他のパッケージからシンボルをインポートします。モジュール、インターフェース、パッケージの要素としてだけでなくトップレベルにも配置することができます。<code>import</code> 宣言の引数には <code>package::*</code> のようなワイルドカードパターンを使用することができます。</p>
<pre><code class="language-veryl playground">// ファイルスコープインポート
import $sv::SvPackage::*;

module ModuleA {
    import PackageA::*;
    import PackageA::paramA;
}

package PackageA {
    local paramA: u32 = 1;
}
</code></pre>
<p><code>export</code> 宣言は宣言したパッケージからシンボルをエクスポートします。全てのシンボルをエクスポートするには <code>export *</code> を使用します。</p>
<pre><code class="language-veryl playground">package PackageA {
    local paramA: u32 = 1;
}

package PackageB {
    import PackageA::*;
    export paramA;
}

package PackageC {
    import PackageA::*;
    export *;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="モジュール-1"><a class="header" href="#モジュール-1">モジュール</a></h1>
<p>モジュールはソースコードの最上位コンポーネントの1つです。モジュールはオーバーライド可能なパラメータ、接続ポート、内部ロジックを持ちます。</p>
<p>オーバーライド可能なパラメータは <code>#()</code> 内で宣言できます。それぞれのパラメータ宣言は <code>param</code> キーワードで始まり、識別子、<code>:</code>、パラメータの型、デフォルト値で構成されます。</p>
<p>接続ポートは <code>()</code> 内で宣言できます。それぞれのポート宣言は識別子、<code>:</code>、ポートの方向、ポートの型で構成されます。利用可能なポート方向は以下の通りです。</p>
<ul>
<li><code>input</code>：入力ポート</li>
<li><code>output</code>：出力ポート</li>
<li><code>inout</code>：双方向ポート</li>
<li><code>modport</code>：インターフェースのmodport</li>
</ul>
<pre><code class="language-veryl playground">module ModuleA #(
    param ParamA: u32 = 0,
    param ParamB: u32 = 0,
) (
    a: input  logic,
    b: input  logic,
    c: input  logic,
    x: output logic,
) {
    always_comb {
        if c {
            x = a;
        } else {
            x = b;
        }
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="インターフェース-1"><a class="header" href="#インターフェース-1">インターフェース</a></h1>
<p>インターフェースはソースコードの最上位コンポーネントの1つです。インターフェースはオーバーライド可能なパラメータ、インターフェース定義を持ちます。</p>
<p>オーバーライド可能なパラメータについてはモジュールと同じです。</p>
<p>インターフェース定義では <code>modport</code> を宣言することができます。<code>modport</code> はモジュールのポート宣言で、ポートを束ねて接続するために使うことができます。</p>
<pre><code class="language-veryl playground">interface InterfaceA #(
    param ParamA: u32 = 0,
    param ParamB: u32 = 0,
) {
    var a: logic;
    var b: logic;

    modport master {
        a: output,
        b: input ,
    }

    modport slave {
        b: input ,
        a: output,
    }
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="パッケージ-1"><a class="header" href="#パッケージ-1">パッケージ</a></h1>
<p>パッケージはソースコードの最上位コンポーネントの1つです。パッケージはパラメータや関数などいくつかの宣言をまとめることができます。</p>
<p>パッケージ内の要素にアクセスするには、<code>::</code> 記号を使って <code>PackageA::ParamA</code> のようにします。</p>
<pre><code class="language-veryl playground">package PackageA {
    local ParamA: u32 = 0;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="systemverilogとの相互運用"><a class="header" href="#systemverilogとの相互運用">SystemVerilogとの相互運用</a></h1>
<p>SystemVerilogの要素にアクセスする場合は <code>$sv</code> 名前空間を使えます。例えば、SystemVerilogソースコードの “ModuleA” は <code>$sv::ModuleA</code> です。Veryl はこれらの要素が実際に存在するかどうかは確認しません。</p>
<pre><code class="language-veryl playground">module ModuleA {
    let _a: logic = $sv::PackageA::ParamA;

    inst b: $sv::ModuleB;
    inst c: $sv::InterfaceC;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="可視性"><a class="header" href="#可視性">可視性</a></h1>
<p>デフォルトではプロジェクトのトップレベルアイテム（モジュール、インターフェース、パッケージ）はプライベートです。プライベートとは他のプロジェクトから参照できないことを意味します。</p>
<p><code>pub</code> キーワードによって他のプロジェクトから見えるように指定することができます。<code>veryl doc</code> コマンドはパブリックなアイテムの <a href="05_language_reference/../05_development_environment/09_documentation.html">ドキュメント</a> のみを生成します。</p>
<pre><code class="language-veryl playground">pub module ModuleA {}

pub interface InterfaceA {}

pub package PackageA {}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="他言語組み込み"><a class="header" href="#他言語組み込み">他言語組み込み</a></h1>
<h2 id="embed-宣言"><a class="header" href="#embed-宣言"><code>embed</code> 宣言</a></h2>
<p><code>embed</code> 宣言により他言語をコードに埋め込むことができます。<code>embed</code> 宣言の第一引数は埋め込み方法です。以下の方法がサポートされています。</p>
<ul>
<li><code>inline</code>: コードをそのまま展開する</li>
</ul>
<p>コードブロックは <code>lang{{{</code> で始まり、<code>}}}</code> で終わります。以下の <code>lang</code> 指示子がサポートされています。</p>
<ul>
<li><code>sv</code>: SystemVerilog</li>
</ul>
<pre><code class="language-veryl playground">embed (inline) sv{{{
    module ModuleSv;
    endmodule
}}}
</code></pre>
<h2 id="include-宣言"><a class="header" href="#include-宣言"><code>include</code> 宣言</a></h2>
<p><code>include</code> 宣言により他言語のファイルを含めることができます。<code>include</code> 宣言の第一引数は <code>embed</code> 宣言と同じです。第二引数はソースコードからの相対ファイルパスです。</p>
<pre><code class="language-veryl">include(inline, "module.sv");
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="組み込みテスト"><a class="header" href="#組み込みテスト">組み込みテスト</a></h1>
<p>組み込みテストは <code>#[test(test_name)]</code> アトリビュートでマークすることができます。マークされたブロックはテストとして認識され、 <code>veryl test</code> コマンドによって実行されます。ブロックのトップレベルモジュールはテスト名と同じでなければなりません。</p>
<p><code>$info</code>、<code>$warning</code>、<code>$error</code>、<code>$fatal</code> システム関数によるメッセージは Veryl コンパイラにより実行ログとして表示されます。<code>$error</code> と <code>$fatal</code> の呼び出しはテストの失敗として扱われます。</p>
<p>以下の例では SystemVerilog のソースコードを <code>embed</code> 宣言で埋め込み、テストとしてマークしています。</p>
<pre><code class="language-veryl playground">#[test(test1)]
embed (inline) sv{{{
    module test1;
        initial begin
            assert (0) else $error("error");
        end
    endmodule
}}}
</code></pre>
<p><code>veryl test</code> で使用される RTLシミュレータについては <a href="05_language_reference/../06_development_environment/07_simulator.html">シミュレータ</a> を参照してください。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ジェネリクス"><a class="header" href="#ジェネリクス">ジェネリクス</a></h1>
<p>ジェネリクスはパラメータオーバーライドでは実現できないアイテムのパラメータ化を可能にします。以下のアイテムがジェネリクスをサポートしています。</p>
<ul>
<li>関数</li>
<li>モジュール</li>
<li>インターフェース</li>
<li>パッケージ</li>
<li>構造体</li>
<li>ユニオン</li>
</ul>
<p>それぞれのジェネリック定義はジェネリックパラメータ（<code>T</code> のような大文字1文字がよく使われます）を持ち、定義内で識別子や式として配置できます。ジェネリックパラメータはアイテムの識別子の後に <code>::&lt;&gt;</code> を用いて宣言します。</p>
<p>ジェネリクスを使用するためには <code>::&lt;&gt;</code> を用いて実パラメータを与えます。実パラメータとしては数値リテラルと <code>::</code> で連結された識別子を使用することができます。</p>
<p>さらに、実パラメータはジェネリクス定義位置から参照できなければなりません。例えば、モジュール名はプロジェクト全体から参照できるので、実パラメータとして使用できます。一方、ローカルパラメータは多くの場合、実パラメータとして使用できません。これはローカルパラメータがジェネリクス定義位置からは参照できない場合に発生します。</p>
<h2 id="ジェネリック関数"><a class="header" href="#ジェネリック関数">ジェネリック関数</a></h2>
<pre><code class="language-veryl playground">module ModuleA {
    function FuncA::&lt;T&gt; (
        a: input logic&lt;T&gt;,
    ) -&gt; logic&lt;T&gt; {
        return a + 1;
    }

    let _a: logic&lt;10&gt; = FuncA::&lt;10&gt;(1);
    let _b: logic&lt;20&gt; = FuncA::&lt;20&gt;(1);
}
</code></pre>
<h2 id="ジェネリックモジュールインターフェース"><a class="header" href="#ジェネリックモジュールインターフェース">ジェネリックモジュール/インターフェース</a></h2>
<pre><code class="language-veryl playground">module ModuleA {
    inst u0: ModuleB::&lt;ModuleC&gt;;
    inst u1: ModuleB::&lt;ModuleD&gt;;
}

module ModuleB::&lt;T&gt; {
    inst u: T;
}

module ModuleC {}
module ModuleD {}
</code></pre>
<h2 id="ジェネリックパッケージ"><a class="header" href="#ジェネリックパッケージ">ジェネリックパッケージ</a></h2>
<pre><code class="language-veryl playground">module ModuleA {
    local A: u32 = PackageA::&lt;1&gt;::X;
    local B: u32 = PackageA::&lt;2&gt;::X;
}

package PackageA::&lt;T&gt; {
    local X: u32 = T;
}
</code></pre>
<h2 id="ジェネリック構造体"><a class="header" href="#ジェネリック構造体">ジェネリック構造体</a></h2>
<pre><code class="language-veryl playground">module ModuleA {
    type TypeA = i32;

    struct StructA::&lt;T&gt; {
        A: T,
    }

    // ローカルに定位された型が使用できています
    // これは `TypeA` が `StructA` の定義位置から参照できるためです
    var _a: StructA::&lt;TypeA&gt;          ;
    var _b: StructA::&lt;PackageA::TypeB&gt;;
    var _c: StructA::&lt;PackageA::TypeC&gt;;
}

package PackageA {
    type TypeB = u32;
    type TypeC = u64;
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="デフォルトパラメータ"><a class="header" href="#デフォルトパラメータ">デフォルトパラメータ</a></h1>
<p>ジェネリックパラメータはその後に <code>=</code> を加えることででフォルト値を指定することができます。呼び出し側でパラメータ指定が省略された場合にデフォルト値が使われます。</p>
<pre><code class="language-veryl playground">module ModuleA {
    function FuncA::&lt;T = 10&gt; (
        a: input logic&lt;T&gt;,
    ) -&gt; logic&lt;T&gt; {
        return a + 1;
    }

    let _a: logic&lt;10&gt; = FuncA::&lt;&gt;(1);
    let _b: logic&lt;20&gt; = FuncA::&lt;20&gt;(1);
}
</code></pre>
<p>デフォルトパラメータはジェネリックパラメータリストの最後に置く必要があります。そうでなければ、どのパラメータが省略されたかが曖昧になるためです。</p>
<pre><code class="language-veryl playground">module ModuleA {
    function FuncA::&lt;T, U = 1&gt; (
        a: input logic&lt;T&gt;,
    ) -&gt; logic&lt;T&gt; {
        return a + U;
    }

    // エラー
    //function FuncA::&lt;T = 1, U&gt; (
    //    a: input logic&lt;T&gt;,
    //) -&gt; logic&lt;T&gt; {
    //    return a + U;
    //}

    let _a: logic&lt;10&gt; = FuncA::&lt;10&gt;(1);
    let _b: logic&lt;20&gt; = FuncA::&lt;20, 2&gt;(1);
}
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="開発環境"><a class="header" href="#開発環境">開発環境</a></h1>
<p>この章ではプロジェクト設定や開発ツールなど開発環境について説明します。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="プロジェクト設定"><a class="header" href="#プロジェクト設定">プロジェクト設定</a></h1>
<ul>
<li><a href="06_development_environment/01_project_configuration.html#the-project-section"><code>[project]</code></a> — プロジェクト定義
<ul>
<li><a href="06_development_environment/01_project_configuration.html#the-name-field"><code>name</code></a> — プロジェクトの名前</li>
<li><a href="06_development_environment/01_project_configuration.html#the-version-field"><code>version</code></a> — プロジェクトのバージョン</li>
<li><a href="06_development_environment/01_project_configuration.html#the-authors-field"><code>authors</code></a> — プロジェクトの作者</li>
<li><a href="06_development_environment/01_project_configuration.html#the-description-field"><code>description</code></a> — プロジェクトの説明</li>
<li><a href="06_development_environment/01_project_configuration.html#the-license-field"><code>license</code></a> — プロジェクトのライセンス</li>
<li><a href="06_development_environment/01_project_configuration.html#the-repository-field"><code>repository</code></a> — プロジェクトのリポジトリの URL</li>
</ul>
</li>
<li><a href="06_development_environment/01_project_configuration.html#the-build-section"><code>[build]</code></a> — ビルド設定</li>
<li><a href="06_development_environment/01_project_configuration.html#the-format-section"><code>[format]</code></a> — フォーマット設定</li>
<li><a href="06_development_environment/01_project_configuration.html#the-lint-section"><code>[lint]</code></a> — リント設定</li>
<li><a href="06_development_environment/01_project_configuration.html#the-test-section"><code>[test]</code></a> — テスト設定</li>
<li><a href="06_development_environment/01_project_configuration.html#the-publish-section"><code>[publish]</code></a> — 公開設定</li>
<li><a href="06_development_environment/01_project_configuration.html#the-dependencies-section"><code>[dependencies]</code></a> — ライブラリの依存関係</li>
</ul>
<h2 id="the-project-section"><a class="header" href="#the-project-section"><code>[project]</code> セクション</a></h2>
<p><code>Veryl.toml</code> の最初のセクションは <code>[project]</code> です。<code>name</code> と <code>version</code> は必須です。</p>
<h3 id="the-name-field"><a class="header" href="#the-name-field"><code>name</code> フィールド</a></h3>
<p>プロジェクト名は生成されるコードのプレフィックスに使われます。そのためプロジェクト名はアルファベットか <code>_</code> で始まり、英数字と<code>_</code> しか使ってはいけません。</p>
<h3 id="the-version-field"><a class="header" href="#the-version-field"><code>version</code> フィールド</a></h3>
<p>プロジェクトのバージョンは <a href="https://semver.org/">セマンティックバージョニング</a>に従います。バージョンは以下の3つの数字からなります。</p>
<ul>
<li>メジャー – 互換性のない変更時に上げる</li>
<li>マイナー – 互換性のある機能追加時に上げる</li>
<li>バッチ – 互換性のあるバグ修正時に上げる</li>
</ul>
<pre><code class="language-toml">[project]
version = "0.1.0"
</code></pre>
<h3 id="the-authors-field"><a class="header" href="#the-authors-field"><code>authors</code> フィールド</a></h3>
<p>オプションの <code>authors</code> フィールドにはこのプロジェクトの作者である人や組織を配列にリストアップします。配列内の各文字列のフォーマットは自由です。名前のみ、Eメールアドレスのみ、名前と括弧で囲んだEメールアドレスといった形式がよく使われます。</p>
<pre><code class="language-toml">[project]
authors = ["Fnu Lnu", "anonymous@example.com", "Fnu Lnu &lt;anonymous@example.com&gt;"]
</code></pre>
<h3 id="the-description-field"><a class="header" href="#the-description-field"><code>description</code> フィールド</a></h3>
<p><code>description</code> はプロジェクトの短い説明です。マークダウンではなくプレーンテキスト形式で書きます。</p>
<h3 id="the-license-field"><a class="header" href="#the-license-field"><code>license</code> フィールド</a></h3>
<p><code>license</code> フィールドはこのプロジェクトがどのライセンスで公開されているかを指定します。指定する文字列は<a href="https://spdx.github.io/spdx-spec/v2.3/SPDX-license-expressions">SPDX 2.3 license expression</a>に従ってください。</p>
<pre><code class="language-toml">[project]
license = "MIT OR Apache-2.0"
</code></pre>
<h3 id="the-repository-field"><a class="header" href="#the-repository-field"><code>repository</code> フィールド</a></h3>
<p><code>repository</code> フィールドはプロジェクトのソースリポジトリへのURLです。</p>
<pre><code class="language-toml">[project]
repository = "https://github.com/veryl-lang/veryl"
</code></pre>
<h2 id="the-build-section"><a class="header" href="#the-build-section"><code>[build]</code> セクション</a></h2>
<p><code>[build]</code> セクションはコード生成の設定です。詳細は<a href="06_development_environment/./01_project_configuration/01_build.html">こちら</a>。</p>
<h2 id="the-format-section"><a class="header" href="#the-format-section"><code>[format]</code> セクション</a></h2>
<p><code>[format]</code> セクションはコードフォーマッターの設定です。詳細は<a href="06_development_environment/./01_project_configuration/02_format.html">こちら</a>。</p>
<h2 id="the-lint-section"><a class="header" href="#the-lint-section"><code>[lint]</code> セクション</a></h2>
<p><code>[lint]</code> セクションはリンタの設定です。詳細は<a href="06_development_environment/./01_project_configuration/03_lint.html">こちら</a>。</p>
<h2 id="the-test-section"><a class="header" href="#the-test-section"><code>[test]</code> セクション</a></h2>
<p><code>[test]</code> セクションはRTLシミュレータによるテストの設定です。詳細は<a href="06_development_environment/./01_project_configuration/04_test.html">こちら</a>。</p>
<h2 id="the-publish-section"><a class="header" href="#the-publish-section"><code>[publish]</code> セクション</a></h2>
<p><code>[publish]</code> セクションはプロジェクト公開の設定です。詳細は<a href="06_development_environment/./01_project_configuration/05_publish.html">こちら</a>。</p>
<h2 id="the-dependencies-section"><a class="header" href="#the-dependencies-section"><code>[dependencies]</code> セクション</a></h2>
<p><code>[dependencies]</code> セクションはライブラリの依存関係です。詳細は<a href="06_development_environment/./02_dependencies.html">こちら</a>。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="build"><a class="header" href="#build">Build</a></h1>
<p><code>[build]</code> セクションはコード生成の設定です。</p>
<h2 id="clock_type-フィールド"><a class="header" href="#clock_type-フィールド"><code>clock_type</code> フィールド</a></h2>
<p><code>clock_type</code> フィールドはフリップフロップを駆動するクロックエッジを指定します。</p>
<ul>
<li><code>posedge</code> – 立ち上がりエッジ</li>
<li><code>negedge</code> – 立ち下がりエッジ</li>
</ul>
<h2 id="reset_type-フィールド"><a class="header" href="#reset_type-フィールド"><code>reset_type</code> フィールド</a></h2>
<p><code>reset_type</code> フィールドはリセットの極性と同期性を指定します。</p>
<ul>
<li><code>async_low</code> – 非同期・負極性</li>
<li><code>async_high</code> – 非同期・正極性</li>
<li><code>sync_low</code> – 同期・負極性</li>
<li><code>sync_high</code> – 同期・正極性</li>
</ul>
<h2 id="filelist_type-フィールド"><a class="header" href="#filelist_type-フィールド"><code>filelist_type</code> フィールド</a></h2>
<p><code>filelist_type</code> フィールドはファイルリストのフォーマットを指定します。</p>
<ul>
<li><code>absolute</code> – プレーンテキスト形式の絶対パスのリスト</li>
<li><code>relative</code> – プレーンテキスト形式の相対パスのリスト</li>
<li><code>flgen</code> – <a href="https://github.com/pezy-computing/flgen">flgen</a> 形式のファイルリスト</li>
</ul>
<h2 id="target-フィールド"><a class="header" href="#target-フィールド"><code>target</code> フィールド</a></h2>
<p><code>target</code> フィールドはコードの生成先を指定します。</p>
<ul>
<li><code>source</code> – ソースコードと同じディレクトリ</li>
<li><code>directory</code> – 特定のディレクトリ</li>
<li><code>bundle</code> – 特定のファイル</li>
</ul>
<p><code>directory</code> あるいは <code>bundle</code> を指定する場合は、ターゲットパスを <code>path</code> キーで指定します。</p>
<pre><code class="language-toml">[build]
target = {type = "directory", path = "[dst dir]"}
</code></pre>
<h2 id="implicit_parameter_types-フィールド"><a class="header" href="#implicit_parameter_types-フィールド"><code>implicit_parameter_types</code> フィールド</a></h2>
<p><code>implicit_parameter_types</code> フィールドは生成コードの <code>parameter</code> 宣言で省略する型をリストアップします。いくつかのEDAツールでは特定の型（例えば <code>string</code>）を <code>parameter</code> 宣言で使うことができないためです。例えば <code>string</code> を指定する場合は以下のようにします。</p>
<pre><code class="language-toml">[build]
implicit_parameter_types = ["string"]
</code></pre>
<h2 id="omit_project_prefix-フィールド"><a class="header" href="#omit_project_prefix-フィールド"><code>omit_project_prefix</code> フィールド</a></h2>
<p><code>omit_project_prefix</code> が <code>true</code> のとき、モジュール・インターフェース・パッケージ名のプロジェクトプレフィックスは省略されます。この値はデフォルトで <code>false</code> です。</p>
<pre><code class="language-toml">[build]
omit_project_prefix = true
</code></pre>
<h2 id="strip_comments-フィールド"><a class="header" href="#strip_comments-フィールド"><code>strip_comments</code> フィールド</a></h2>
<p><code>strip_comments</code> が <code>true</code> のとき、コメント出力は省略されます。この値はデフォルトで <code>false</code> です。</p>
<pre><code class="language-toml">[build]
strip_comments = true
</code></pre>
<h2 id="_prefix-と-_suffix-フィールド"><a class="header" href="#_prefix-と-_suffix-フィールド"><code>*_prefix</code> と <code>*_suffix</code> フィールド</a></h2>
<p><code>*_prefix</code> and <code>*_suffix</code> represent additional prefix and suffix for the generated code.  The available configurations are below:</p>
<ul>
<li><code>clock_posedge_prefix</code>: <code>clock_type = posedge</code> のときの <code>clock</code> 型のプレフィックス</li>
<li><code>clock_posedge_suffix</code>: <code>clock_type = posedge</code> のときの <code>clock</code> 型のサフィックス</li>
<li><code>clock_negedge_prefix</code>: <code>clock_type = negedge</code> のときの <code>clock</code> 型のプレフィックス</li>
<li><code>clock_negedge_suffix</code>: <code>clock_type = negedge</code> のときの <code>clock</code> 型のサフィックス</li>
<li><code>reset_high_prefix</code>: <code>reset_type = *_high</code> のときの <code>reset</code> 型のプレフィックス</li>
<li><code>reset_high_suffix</code>: <code>reset_type = *_high</code> のときの <code>reset</code> 型のサフィックス</li>
<li><code>reset_low_prefix</code>: <code>reset_type = *_low</code> のときの <code>reset</code> 型のプレフィックス</li>
<li><code>reset_low_suffix</code>: <code>reset_type = *_low</code> のときの <code>reset</code> 型のサフィックス</li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="format"><a class="header" href="#format">Format</a></h1>
<p><code>[format]</code> セクションはフォーマッタの設定です。</p>
<pre><code class="language-toml">[format]
indent_width = 4
</code></pre>
<h2 id="設定"><a class="header" href="#設定">設定</a></h2>
<div class="table-wrapper"><table><thead><tr><th>設定</th><th>設定値</th><th>説明</th></tr></thead><tbody>
<tr><td>indent_width</td><td>整数</td><td>インデントのスペース幅</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="lint"><a class="header" href="#lint">Lint</a></h1>
<p><code>[lint]</code> セクションはリンターの設定です。</p>
<pre><code class="language-toml">[lint.naming]
case_enum = "snake"
</code></pre>
<h2 id="設定-1"><a class="header" href="#設定-1">設定</a></h2>
<h3 id="lintnaming-セクション"><a class="header" href="#lintnaming-セクション"><code>[lint.naming]</code> セクション</a></h3>
<p>このセクションは命名規則の設定です。</p>
<div class="table-wrapper"><table><thead><tr><th>設定</th><th>設定値</th><th>説明</th></tr></thead><tbody>
<tr><td>case_enum</td><td>ケースタイプ<sup class="footnote-reference"><a href="#casetype">1</a></sup></td><td><code>enum</code> のケーススタイル</td></tr>
<tr><td>case_function</td><td>ケースタイプ<sup class="footnote-reference"><a href="#casetype">1</a></sup></td><td><code>function</code> のケーススタイル</td></tr>
<tr><td>case_instance</td><td>ケースタイプ<sup class="footnote-reference"><a href="#casetype">1</a></sup></td><td>インスタンスのケーススタイル</td></tr>
<tr><td>case_interface</td><td>ケースタイプ<sup class="footnote-reference"><a href="#casetype">1</a></sup></td><td><code>interface</code> のケーススタイル</td></tr>
<tr><td>case_modport</td><td>ケースタイプ<sup class="footnote-reference"><a href="#casetype">1</a></sup></td><td><code>modport</code> のケーススタイル</td></tr>
<tr><td>case_module</td><td>ケースタイプ<sup class="footnote-reference"><a href="#casetype">1</a></sup></td><td><code>module</code> のケーススタイル</td></tr>
<tr><td>case_package</td><td>ケースタイプ<sup class="footnote-reference"><a href="#casetype">1</a></sup></td><td><code>package</code> のケーススタイル</td></tr>
<tr><td>case_parameter</td><td>ケースタイプ<sup class="footnote-reference"><a href="#casetype">1</a></sup></td><td><code>parameter</code> のケーススタイル</td></tr>
<tr><td>case_port_inout</td><td>ケースタイプ<sup class="footnote-reference"><a href="#casetype">1</a></sup></td><td><code>inout</code> ポートのケーススタイル</td></tr>
<tr><td>case_port_input</td><td>ケースタイプ<sup class="footnote-reference"><a href="#casetype">1</a></sup></td><td><code>input</code> ポートのケーススタイル</td></tr>
<tr><td>case_port_modport</td><td>ケースタイプ<sup class="footnote-reference"><a href="#casetype">1</a></sup></td><td><code>modport</code> ポートのケーススタイル</td></tr>
<tr><td>case_port_output</td><td>ケースタイプ<sup class="footnote-reference"><a href="#casetype">1</a></sup></td><td><code>output</code> ポートのケーススタイル</td></tr>
<tr><td>case_reg</td><td>ケースタイプ<sup class="footnote-reference"><a href="#casetype">1</a></sup></td><td>レジスタ変数<sup class="footnote-reference"><a href="#reg">2</a></sup>のケーススタイル</td></tr>
<tr><td>case_struct</td><td>ケースタイプ<sup class="footnote-reference"><a href="#casetype">1</a></sup></td><td><code>struct</code> のケーススタイル</td></tr>
<tr><td>case_wire</td><td>ケースタイプ<sup class="footnote-reference"><a href="#casetype">1</a></sup></td><td>ワイヤ変数<sup class="footnote-reference"><a href="#wire">3</a></sup>のケーススタイル</td></tr>
<tr><td>prefix_enum</td><td>文字列</td><td><code>enum</code> のプレフィックス</td></tr>
<tr><td>prefix_function</td><td>文字列</td><td><code>function</code> のプレフィックス</td></tr>
<tr><td>prefix_instance</td><td>文字列</td><td>インスタンスのプレフィックス</td></tr>
<tr><td>prefix_interface</td><td>文字列</td><td><code>interface</code> のプレフィックス</td></tr>
<tr><td>prefix_modport</td><td>文字列</td><td><code>modport</code> のプレフィックス</td></tr>
<tr><td>prefix_module</td><td>文字列</td><td><code>module</code> のプレフィックス</td></tr>
<tr><td>prefix_package</td><td>文字列</td><td><code>package</code> のプレフィックス</td></tr>
<tr><td>prefix_parameter</td><td>文字列</td><td><code>parameter</code> のプレフィックス</td></tr>
<tr><td>prefix_port_inout</td><td>文字列</td><td><code>inout</code> ポートのプレフィックス</td></tr>
<tr><td>prefix_port_input</td><td>文字列</td><td><code>input</code> ポートのプレフィックス</td></tr>
<tr><td>prefix_port_modport</td><td>文字列</td><td><code>modport</code> ポートのプレフィックス</td></tr>
<tr><td>prefix_port_output</td><td>文字列</td><td><code>output</code> ポートのプレフィックス</td></tr>
<tr><td>prefix_reg</td><td>文字列</td><td>レジスタ変数<sup class="footnote-reference"><a href="#reg">2</a></sup>のプレフィックス</td></tr>
<tr><td>prefix_struct</td><td>文字列</td><td><code>struct</code> のプレフィックス</td></tr>
<tr><td>prefix_wire</td><td>文字列</td><td>ワイヤ変数<sup class="footnote-reference"><a href="#wire">3</a></sup>のプレフィックス</td></tr>
<tr><td>re_forbidden_enum</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>enum</code> の禁止正規表現</td></tr>
<tr><td>re_forbidden_function</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>function</code> の禁止正規表現</td></tr>
<tr><td>re_forbidden_instance</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td>インスタンスの禁止正規表現</td></tr>
<tr><td>re_forbidden_interface</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>interface</code> の禁止正規表現</td></tr>
<tr><td>re_forbidden_modport</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>modport</code> の禁止正規表現</td></tr>
<tr><td>re_forbidden_module</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>module</code> の禁止正規表現</td></tr>
<tr><td>re_forbidden_package</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>package</code> の禁止正規表現</td></tr>
<tr><td>re_forbidden_parameter</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>parameter</code> の禁止正規表現</td></tr>
<tr><td>re_forbidden_port_inout</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>inout</code> ポートの禁止正規表現</td></tr>
<tr><td>re_forbidden_port_input</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>input</code> ポートの禁止正規表現</td></tr>
<tr><td>re_forbidden_port_modport</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>modport</code> ポートの禁止正規表現</td></tr>
<tr><td>re_forbidden_port_output</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>output</code> ポートの禁止正規表現</td></tr>
<tr><td>re_forbidden_reg</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td>レジスタ変数<sup class="footnote-reference"><a href="#reg">2</a></sup>の禁止正規表現</td></tr>
<tr><td>re_forbidden_struct</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>struct</code> の禁止正規表現</td></tr>
<tr><td>re_forbidden_wire</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td>ワイヤ変数<sup class="footnote-reference"><a href="#wire">3</a></sup>の禁止正規表現</td></tr>
<tr><td>re_required_enum</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>enum</code> の必須正規表現</td></tr>
<tr><td>re_required_function</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>function</code> の必須正規表現</td></tr>
<tr><td>re_required_instance</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td>インスタンスの必須正規表現</td></tr>
<tr><td>re_required_interface</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>interface</code> の必須正規表現</td></tr>
<tr><td>re_required_modport</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>modport</code> の必須正規表現</td></tr>
<tr><td>re_required_module</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>module</code> の必須正規表現</td></tr>
<tr><td>re_required_package</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>package</code> の必須正規表現</td></tr>
<tr><td>re_required_parameter</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>parameter</code> の必須正規表現</td></tr>
<tr><td>re_required_port_inout</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>inout</code> ポートの必須正規表現</td></tr>
<tr><td>re_required_port_input</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>input</code> ポートの必須正規表現</td></tr>
<tr><td>re_required_port_modport</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>modport</code> ポートの必須正規表現</td></tr>
<tr><td>re_required_port_output</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>output</code> ポートの必須正規表現</td></tr>
<tr><td>re_required_reg</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td>レジスタ変数<sup class="footnote-reference"><a href="#reg">2</a></sup>の必須正規表現</td></tr>
<tr><td>re_required_struct</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td><code>struct</code> の必須正規表現</td></tr>
<tr><td>re_required_wire</td><td>正規表現<sup class="footnote-reference"><a href="#regex">4</a></sup></td><td>ワイヤ変数<sup class="footnote-reference"><a href="#wire">3</a></sup>の必須正規表現</td></tr>
</tbody></table>
</div>
<div class="footnote-definition" id="casetype"><sup class="footnote-definition-label">1</sup>
<p>設定可能な値は以下です。</p>
</div>
<ul>
<li><code>"snake"</code> – snake_case</li>
<li><code>"screaming_snake"</code> – SCREAMING_SNAKE_CASE</li>
<li><code>"lower_camel"</code> – lowerCamelCase</li>
<li><code>"upper_camel"</code> – UpperCamelCase</li>
</ul>
<div class="footnote-definition" id="regex"><sup class="footnote-definition-label">4</sup>
<p><code>".*"</code>のような正規表現です。使用可能な構文は<a href="https://docs.rs/regex/latest/regex/#syntax">こちら</a>.</p>
</div>
<div class="footnote-definition" id="reg"><sup class="footnote-definition-label">2</sup>
<p>レジスタ変数とは <code>always_ff</code> で代入される変数です。合成フェーズでフリップフロップにマップされます。</p>
</div>
<div class="footnote-definition" id="wire"><sup class="footnote-definition-label">3</sup>
<p>ワイヤ変数とは <code>always_comb</code> で代入される変数です。合成フェーズでワイヤにマップされます。</p>
</div>
<div style="break-before: page; page-break-before: always;"></div><h1 id="test"><a class="header" href="#test">Test</a></h1>
<p><code>[test]</code> セクションは以下のように組み込みユニットテストの設定を指定します。</p>
<pre><code class="language-toml">[test]
simulator = "vcs"
</code></pre>
<h2 id="設定-2"><a class="header" href="#設定-2">設定</a></h2>
<h2 id="test-セクション"><a class="header" href="#test-セクション"><code>[test]</code> セクション</a></h2>
<p>このセクションはテストの設定です。</p>
<div class="table-wrapper"><table><thead><tr><th>設定</th><th>設定値</th><th>説明</th></tr></thead><tbody>
<tr><td>simulator</td><td>シミュレータ名<sup class="footnote-reference"><a href="#sim">1</a></sup></td><td>デフォルトのシミュレータ</td></tr>
</tbody></table>
</div>
<div class="footnote-definition" id="sim"><sup class="footnote-definition-label">1</sup>
<p>設定可能な値は以下です。</p>
</div>
<ul>
<li><code>"verilator"</code></li>
<li><code>"vcs"</code></li>
<li><code>"vivado"</code></li>
</ul>
<h2 id="testverilator-セクション"><a class="header" href="#testverilator-セクション"><code>[test.verilator]</code> セクション</a></h2>
<p>このセクションはVerilatorによるテストの設定です。</p>
<div class="table-wrapper"><table><thead><tr><th>設定</th><th>設定値</th><th>説明</th></tr></thead><tbody>
<tr><td>compile_args</td><td>[文字列]</td><td><code>verilator</code> コマンドへの追加の引数</td></tr>
<tr><td>simulate_args</td><td>[文字列]</td><td>シミュレーションバイナリへの追加の引数</td></tr>
</tbody></table>
</div>
<h2 id="testvcs-セクション"><a class="header" href="#testvcs-セクション"><code>[test.vcs]</code> セクション</a></h2>
<p>このセクションはVCSによるテストの設定です。</p>
<div class="table-wrapper"><table><thead><tr><th>設定</th><th>設定値</th><th>説明</th></tr></thead><tbody>
<tr><td>compile_args</td><td>[文字列]</td><td><code>vcs</code> コマンドへの追加の引数</td></tr>
<tr><td>simulate_args</td><td>[文字列]</td><td>シミュレーションバイナリへの追加の引数</td></tr>
</tbody></table>
</div>
<h2 id="testvivado-セクション"><a class="header" href="#testvivado-セクション"><code>[test.vivado]</code> セクション</a></h2>
<p>このセクションはVivadoによるテストの設定です。</p>
<div class="table-wrapper"><table><thead><tr><th>設定</th><th>設定値</th><th>説明</th></tr></thead><tbody>
<tr><td>compile_args</td><td>[文字列]</td><td><code>xvlog</code> コマンドへの追加の引数</td></tr>
<tr><td>elaborate_args</td><td>[文字列]</td><td><code>xelab</code> コマンドへの追加の引数</td></tr>
<tr><td>simulate_args</td><td>[文字列]</td><td><code>xsim</code> コマンドへの追加の引数</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="publish"><a class="header" href="#publish">Publish</a></h1>
<p><code>[publish]</code> セクションは以下のようにプロジェクト公開の設定を指定します。</p>
<pre><code class="language-toml">[publish]
bump_commit = true
bump_commit_message = "Bump"
</code></pre>
<h3 id="設定-3"><a class="header" href="#設定-3">設定</a></h3>
<div class="table-wrapper"><table><thead><tr><th>設定</th><th>設定値</th><th>デフォルト</th><th>説明</th></tr></thead><tbody>
<tr><td>bump_commit</td><td>ブーリアン</td><td>false</td><td>バージョンアップ後の自動コミット</td></tr>
<tr><td>publish_commit</td><td>ブーリアン</td><td>false</td><td>公開後の自動コミット</td></tr>
<tr><td>bump_commit_mesasge</td><td>文字列</td><td>“chore: Bump version”</td><td>バージョンアップ後のコミットメッセージ</td></tr>
<tr><td>publish_commit_mesasge</td><td>文字列</td><td>“chore: Publish”</td><td>公開後のコミットメッセージ</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="依存関係"><a class="header" href="#依存関係">依存関係</a></h1>
<p>他の Veryl プロジェクトへの依存関係をプロジェクトに追加したい場合、<code>Veryl.toml</code> に <code>[dependencies]</code> セクションを追加します。エントリの左辺は依存関係へのパス、右辺はバージョンです。</p>
<pre><code class="language-toml">[dependencies]
"https://github.com/veryl-lang/sample" = "0.1.0"
</code></pre>
<p>デフォルトでは依存関係の名前空間はそのプロジェクト名と同じです。もし名前空間を指定したい場合は、 <code>name</code> フィールドを使います。</p>
<pre><code class="language-toml">[dependencies]
"https://github.com/veryl-lang/sample" = {version = "0.1.0", name = "veryl_sample_alt"}
</code></pre>
<p>同じ依存関係の複数のバージョンを使う場合は、以下のようにそれぞれの名前を指定できます。</p>
<pre><code class="language-toml">[dependencies]
"https://github.com/veryl-lang/sample" = [
    {version = "0.1.0", name = "veryl_sample1"},
    {version = "0.2.0", name = "veryl_sample2"},
]
</code></pre>
<h2 id="依存関係の使用"><a class="header" href="#依存関係の使用">依存関係の使用</a></h2>
<p><code>Veryl.toml</code> に依存関係を追加したあとは、その依存関係の <code>module</code>、<code>interface</code>、<code>package</code>を使うことができます。以下は <code>veryl_sample</code> の依存関係に含まれる <code>delay</code> モジュールを使った例です。</p>
<pre><code class="language-veryl">module ModuleA (
    i_clk: input  clock,
    i_rst: input  reset,
    i_d  : input  logic,
    o_d  : output logic,
) {
    inst u_delay: veryl_sample::delay (
        i_clk,
        i_rst,
        i_d  ,
        o_d  ,
    );
}
</code></pre>
<blockquote>
<p>注：上記のコードのプレイボタンの結果は依存関係解決を行わないので正確ではありません。実際のモジュール名は <code>veryl_samlle_delay</code> になります。</p>
</blockquote>
<h2 id="バージョン要求"><a class="header" href="#バージョン要求">バージョン要求</a></h2>
<p><code>[dependencies]</code> セクションの <code>version</code> フィールドはバージョン要求を示します。例えば、<code>version = "0.1.0"</code> は <code>0.1.0</code> と互換性のある最新バージョンを意味します。互換性は<a href="https://semver.org/">セマンティックバージョニング</a>で判定されます。バージョンは以下の3つの部分からなります。</p>
<ul>
<li><code>メジャー</code> バージョンはAPI非互換な変更</li>
<li><code>マイナー</code> バージョンは互換性のある機能追加</li>
<li><code>パッチ</code> バージョンは互換性のあるバグ修正</li>
</ul>
<p>もし <code>メジャー</code> バージョンが <code>0</code> なら、<code>マイナー</code> が非互換変更と解釈されます。</p>
<p>バージョン <code>0.1.0</code>、<code>0.1.1</code>、<code>0.2.0</code>があった場合、<code>0.1.1</code> が選択されます。これは以下のように決定されます。</p>
<ul>
<li><code>0.1.0</code> は <code>0.1.0</code> と互換性がある</li>
<li><code>0.1.1</code> は <code>0.1.0</code> と互換性がある</li>
<li><code>0.2.0</code> は <code>0.1.0</code> と互換性がない</li>
<li><code>0.1.1</code> は互換性のある最新バージョン</li>
</ul>
<p><code>version</code> フィールドは <code>=0.1.0</code> のような指定も可能です。詳細は Rust のバージョン要求についてのドキュメントを参照してください。<a href="https://doc.rust-lang.org/cargo/reference/specifying-dependencies.html#specifying-dependencies-from-cratesio">Specifying Dependencies</a>.</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="プロジェクトを公開する"><a class="header" href="#プロジェクトを公開する">プロジェクトを公開する</a></h1>
<p>プロジェクトを公開するには <code>veryl publish</code> コマンドを使います。公開とはバージョン番号とgitのリビジョンを紐づけることです。</p>
<pre><code>$ veryl publish
[INFO ]   Publishing release (0.2.1 @ 297bc6b24c5ceca9e648c3ea5e01011c67d7efe7)
[INFO ]      Writing metadata ([path to project]/Veryl.pub)
</code></pre>
<p><code>veryl publish</code> は以下のように公開されたバージョンの情報を含んだ <code>Veryl.pub</code> というファイルを生成します。</p>
<pre><code class="language-toml">[[releases]]
version = "0.2.1"
revision = "297bc6b24c5ceca9e648c3ea5e01011c67d7efe7"
</code></pre>
<p><code>Veryl.pub</code> と生成した後、gitのadd、commit、pushを行えば公開手続きは完了です。gitブランチはデフォルトブランチでなければなりません。これは Veryl が <code>Veryl.pub</code> をデフォルトブランチから探すためです。</p>
<pre><code>$ git add Veryl.pub
$ git commit -m "Publish"
$ git push
</code></pre>
<p><code>Veryl.toml</code> の <code>[publish]</code> セクションに <code>publish_commit</code> を設定して自動コミットを有効にすれば、gitのaddとcommitが自動で実行されます。</p>
<pre><code>$ veryl publish
[INFO ]   Publishing release (0.2.1 @ 297bc6b24c5ceca9e648c3ea5e01011c67d7efe7)
[INFO ]      Writing metadata ([path to project]/Veryl.pub)
[INFO ]   Committing metadata ([path to project]/Veryl.pub)
</code></pre>
<h3 id="バージョンを上げる"><a class="header" href="#バージョンを上げる">バージョンを上げる</a></h3>
<p><code>--bump</code> オプションを使うと公開と同時にバージョンを上げることもできます。公開と同様に、<code>Veryl.toml</code> の<code>[publish]</code> セクションに <code>bump_commit</code> を設定すれば自動でcommitされます。</p>
<pre><code>$ veryl publish --bump patch
[INFO ]      Bumping version (0.2.1 -&gt; 0.2.2)
[INFO ]     Updating version field ([path to project]/Veryl.toml)
[INFO ]   Committing metadata ([path to project]/Veryl.toml)
[INFO ]   Publishing release (0.2.2 @ 159dee3b3f93d3a999d8bac4c6d26d51476b178a)
[INFO ]      Writing metadata ([path to project]/Veryl.pub)
[INFO ]   Committing metadata ([path to project]/Veryl.pub)
</code></pre>
<h3 id="設定-4"><a class="header" href="#設定-4">設定</a></h3>
<p>全設定の説明は<a href="06_development_environment/./01_project_configuration/05_publish.html">こちら</a>。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ディレクトリ構成"><a class="header" href="#ディレクトリ構成">ディレクトリ構成</a></h1>
<p>Veryl は任意のディレクトリ構成をサポートしています。これは独立したプロジェクトと他のプロジェクトに組み込まれたプロジェクトでは最適なディレクトリ構成が異なるためです。</p>
<p>この節ではいくつかのディレクトリ構成パターンを示します。</p>
<h2 id="単一のソースディレクトリ"><a class="header" href="#単一のソースディレクトリ">単一のソースディレクトリ</a></h2>
<p>このパターンでは全てのソースコードは <code>src</code> ディレクトリに配置されます。<code>src</code> 以下のサブディレクトリの構成は自由です。</p>
<pre><code>$ tree
.
|-- src
|   |-- module_a.veryl
|   `-- module_b
|       |-- module_b.veryl
|       `-- module_c.veryl
`-- Veryl.toml

2 directories, 4 files
</code></pre>
<p>Veryl は全ての <code>*.veryl</code> ファイルを収集し、デフォルトではソースと同じディレクトリにコードを生成します。この挙動は以下の設定で明示することもできます。</p>
<pre><code class="language-toml">[build]
target = "source"
</code></pre>
<p><code>veryl build</code> を実行するとディレクトリ構成は以下のようになります。</p>
<pre><code>$ tree
.
|-- dependencies
|-- prj.f
|-- src
|   |-- module_a.sv
|   |-- module_a.veryl
|   `-- module_b
|       |-- module_b.sv
|       |-- module_b.veryl
|       |-- module_c.sv
|       `-- module_c.veryl
`-- Veryl.toml

3 directories, 8 files
</code></pre>
<h2 id="単一のソースとターゲットディレクトリ"><a class="header" href="#単一のソースとターゲットディレクトリ">単一のソースとターゲットディレクトリ</a></h2>
<p>生成されたコードを1つのディレクトリに入れたい場合、<code>Veryl.toml</code> の <code>[build]</code> セクションで <code>target</code> を以下のように設定します。</p>
<pre><code class="language-toml">[build]
target = {type = "directory", path = "target"}
</code></pre>
<p>ディレクトリ構成は以下のようになります。</p>
<pre><code>$ tree
.
|-- dependencies
|-- prj.f
|-- src
|   |-- module_a.veryl
|   `-- module_b
|       |-- module_b.veryl
|       `-- module_c.veryl
|-- target
|   |-- module_a.sv
|   |-- module_b.sv
|   `-- module_c.sv
`-- Veryl.toml

4 directories, 8 files
</code></pre>
<h2 id="マルチソースディレクトリ"><a class="header" href="#マルチソースディレクトリ">マルチソースディレクトリ</a></h2>
<p>既存の SystemVerilog プロジェクトに Veryl のプロジェクトを組み込む場合、以下のような構成にすることもできます。</p>
<pre><code>$ tree
.
|-- dependencies
|-- module_a
|   |-- module_a.sv
|   `-- module_a.veryl
|-- module_b
|   |-- module_b.sv
|   |-- module_b.veryl
|   |-- module_c.sv
|   `-- module_c.veryl
|-- prj.f
|-- sv_module_x
|   `-- sv_module_x.sv
|-- sv_module_y
|   `-- sv_module_y.sv
`-- Veryl.toml

5 directories, 10 files
</code></pre>
<p>生成された <code>prj.f</code> は生成されたソースコードを全てリストアップしているので、既存の SystemVerilog ファイルリストと一緒に使うことができます。</p>
<h2 id="gitignore-について"><a class="header" href="#gitignore-について"><code>.gitignore</code> について</a></h2>
<p>Veryl はデフォルトの <code>.gitignore</code> を提供しません。これはプロジェクト毎にどのファイルを無視する必要があるかが変わるためです。</p>
<p><code>.gitignore</code> の候補としては以下が考えられます。</p>
<ul>
<li><code>dependencies/</code></li>
<li><code>target/</code></li>
<li><code>*.sv</code></li>
<li><code>*.f</code></li>
</ul>
<div style="break-before: page; page-break-before: always;"></div><h1 id="フォーマッタ"><a class="header" href="#フォーマッタ">フォーマッタ</a></h1>
<p><code>veryl fmt</code> コマンドでソースコードをフォーマットできます。あるいは言語サーバの <code>textDocument/formatting</code> 要求によるフォーマットにも対応しています。</p>
<p>全設定の説明は<a href="06_development_environment/./01_project_configuration/02_format.html">こちら</a>。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="リンタ"><a class="header" href="#リンタ">リンタ</a></h1>
<p><code>veryl check</code> あるいは <code>veryl build</code> でリントチェックができます。あるいは言語サーバはリアルタイムでのチェックを行います。</p>
<p>全設定の説明は<a href="06_development_environment/./01_project_configuration/03_lint.html">こちら</a>。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="シミュレータ"><a class="header" href="#シミュレータ">シミュレータ</a></h1>
<p>RTLシミュレータによるテストは <code>veryl test</code> で実行することができます。サポートされているシミュレータは以下の通りです。</p>
<ul>
<li><a href="https://www.veripool.org/verilator/">Verilator</a></li>
<li><a href="https://www.synopsys.com/verification/simulation/vcs.html">Synopsys VCS</a></li>
<li><a href="https://www.xilinx.com/products/design-tools/vivado/verification.html">AMD Vivado Simulator</a></li>
</ul>
<p>Verilatorはデフォルトのシミュレータです。<code>Veryl.toml</code>やコマンドラインオプションでシミュレータが指定されていない場合に使用されます。</p>
<p>全設定の説明は<a href="06_development_environment/./01_project_configuration/04_test.html">こちら</a>。</p>
<div style="break-before: page; page-break-before: always;"></div><h1 id="言語サーバ"><a class="header" href="#言語サーバ">言語サーバ</a></h1>
<p><code>veryl-ls</code> は言語サーバのバイナリです。使用するにはエディタの設定やプラグインが必要です。</p>
<p>設定可能な項目は以下の通りです。これは各エディタの設定から指定できます。</p>
<div class="table-wrapper"><table><thead><tr><th>設定</th><th>設定値</th><th>デフォルト</th><th>説明</th></tr></thead><tbody>
<tr><td>useOperatorCompletion</td><td>ブーリアン</td><td>false</td><td>演算子（例 ‘&gt;:’, ‘&gt;&gt;’）の補完を有効にする</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="互換性"><a class="header" href="#互換性">互換性</a></h1>
<p>いくつかのツールはサポートしていない SystemVerilog 構文があります。これをサポートするために、 <code>Veryl.toml</code> の設定でコード生成をカスタマイズすることができます。</p>
<h2 id="vivado"><a class="header" href="#vivado">Vivado</a></h2>
<h3 id="文字列パラメータ"><a class="header" href="#文字列パラメータ">文字列パラメータ</a></h3>
<p>Vivadoは <code>string</code> 型の <code>parameter</code> をサポートしていません。</p>
<pre><code class="language-verilog">parameter string a = "A";
</code></pre>
<p>その場合は <code>implicit_parameter_types</code> を設定してください。</p>
<pre><code class="language-toml">[build]
implicit_parameter_types = ["string"]
</code></pre>
<p>設定すると生成コードは以下のようになります。</p>
<pre><code class="language-verilog">parameter a = "A";
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="ドキュメンテーション"><a class="header" href="#ドキュメンテーション">ドキュメンテーション</a></h1>
<p>プロジェクトのドキュメントは <code>veryl doc</code> コマンドで生成することができます。全てのパブリックなモジュールとインターフェース、パッケージがリストアップされます。（参照 <a href="06_development_environment/../04_language_reference/11_visibility.html">可視性</a>）</p>
<p>詳細な説明を書きたい場合はドキュメンテーションコメントを追加することもできます。ドキュメンテーションコメントでは<a href="https://www.markdownguide.org">マークダウン</a>記法を使えます。</p>
<p><a href="https://wavedrom.com">WaveDrom</a> による波形記述もサポートされています。<code>wavedrom</code> コードブロック内で、WaveDromの構文を記述することができます。構文の詳細は <a href="https://wavedrom.com/tutorial.html">チュートリアル</a> を参照してください。</p>
<pre><code class="language-veryl playground">/// The detailed description of ModuleA
///
/// * list item0
/// * list item1
///
/// ```wavedrom
/// {signal: [
///   {name: 'clk', wave: 'p.....|...'},
///   {name: 'dat', wave: 'x.345x|=.x', data: ['head', 'body', 'tail', 'data']},
///   {name: 'req', wave: '0.1..0|1.0'},
///   {},
///   {name: 'ack', wave: '1.....|01.'}
///
/// ]}
/// ```
pub module ModuleA #(
    /// Data width
    param ParamA: u32 = 1,
    local ParamB: u32 = 1,
) (
    i_clk : input  clock        , /// Clock
    i_rst : input  reset        , /// Reset
    i_data: input  logic&lt;ParamA&gt;, /// Data input
    o_data: output logic&lt;ParamA&gt;, /// Data output
) {
    assign o_data = 0;
}
</code></pre>
<p>設定可能な項目は以下の通りです。これは <code>Veryl.toml</code> の <code>[doc]</code> セクションで指定できます。</p>
<pre><code class="language-toml">[doc]
path = "document"
</code></pre>
<div class="table-wrapper"><table><thead><tr><th>設定</th><th>設定値</th><th>デフォルト</th><th>説明</th></tr></thead><tbody>
<tr><td>path</td><td>文字列</td><td>“doc”</td><td>出力ディレクトリへのパス</td></tr>
</tbody></table>
</div><div style="break-before: page; page-break-before: always;"></div><h1 id="github-action"><a class="header" href="#github-action">GitHub Action</a></h1>
<p>ビルド済みのVerylバイナリをダウンロードするための公式GitHub actionが提供されています。</p>
<p><a href="https://github.com/marketplace/actions/setup-veryl">https://github.com/marketplace/actions/setup-veryl</a></p>
<p>GitHub actionスクリプトの例は以下の通りです。</p>
<ul>
<li>フォーマットとビルドチェック</li>
</ul>
<pre><code class="language-yaml">name: Check
on: [push, pull_request]
jobs:
  check:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - uses: veryl-lang/setup-veryl@v1
    - run: veryl fmt --check
    - run: veryl check
</code></pre>
<ul>
<li>GitHub Pagesからドキュメントを公開する</li>
</ul>
<pre><code class="language-yaml">name: Deploy
on: [push]
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v4
    - uses: veryl-lang/setup-veryl@v1
    - run: veryl doc
    - uses: peaceiris/actions-gh-pages@v3
      with:
        github_token: ${{ secrets.GITHUB_TOKEN }}
        publish_dir: doc
</code></pre>
<ul>
<li><a href="https://www.veripool.org/verilator/">Verilator</a> によるテスト</li>
</ul>
<p>このために GitHub action <a href="https://github.com/marketplace/actions/setup-verilator">veryl-lang/setup-verilator</a> を公開しています。</p>
<pre><code class="language-yaml">name: Test
on: [push, pull_request]
jobs:
  test:
    runs-on: ubuntu-22.04
    steps:
    - uses: actions/checkout@v4
    - uses: veryl-lang/setup-veryl@v1
    - uses: veryl-lang/setup-verilator@v1
    - run: veryl test --sim verilator
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="補遺"><a class="header" href="#補遺">補遺</a></h1>
<div style="break-before: page; page-break-before: always;"></div><h1 id="構文"><a class="header" href="#構文">構文</a></h1>
<p>Veryl のパーサはパーサジェネレータ <a href="https://github.com/jsinger67/parol">parol</a>を使っています。以下の parol の構文定義が正式な構文です。</p>
<pre><code>
%start Veryl
%title "Veryl grammar"
%comment "Empty grammar generated by `parol`"
%user_type VerylToken = crate::veryl_token::VerylToken
%user_type Token = crate::veryl_token::Token

%scanner Embed {
    %auto_newline_off
    %auto_ws_off
}

%scanner Generic {
}

%%

// ----------------------------------------------------------------------------
// Terminal
// ----------------------------------------------------------------------------

// Longest match should be first

CommentsTerm          : &lt;INITIAL, Generic       &gt;"(?:(?:(?://.*(?:\r\n|\r|\n|$))|(?:(?ms)/\u{2a}.*?\u{2a}/))\s*)+"                     : Token;
StringLiteralTerm     : &lt;INITIAL, Generic       &gt;"\u{0022}(?:\\[\u{0022}\\/bfnrt]|u[0-9a-fA-F]{4}|[^\u{0022}\\\u0000-\u001F])*\u{0022}": Token;
ExponentTerm          : &lt;INITIAL, Generic       &gt;/[0-9]+(?:_[0-9]+)*\.[0-9]+(?:_[0-9]+)*[eE][+-]?[0-9]+(?:_[0-9]+)*/                   : Token;
FixedPointTerm        : &lt;INITIAL, Generic       &gt;/[0-9]+(?:_[0-9]+)*\.[0-9]+(?:_[0-9]+)*/                                              : Token;
BasedTerm             : &lt;INITIAL, Generic       &gt;/(?:[0-9]+(?:_[0-9]+)*)?'[bodh][0-9a-fA-FxzXZ]+(?:_[0-9a-fA-FxzXZ]+)*/                : Token;
AllBitTerm            : &lt;INITIAL, Generic       &gt;/(?:[0-9]+(?:_[0-9]+)*)?'[01xzXZ]/                                                    : Token;
BaseLessTerm          : &lt;INITIAL, Generic       &gt;/[0-9]+(?:_[0-9]+)*/                                                                  : Token;
MinusColonTerm        : &lt;INITIAL                &gt;'-:'                                                                                  : Token;
MinusGTTerm           : &lt;INITIAL                &gt;'-&gt;'                                                                                  : Token;
PlusColonTerm         : &lt;INITIAL                &gt;'+:'                                                                                  : Token;
AssignmentOperatorTerm: &lt;INITIAL                &gt;"\+=|-=|\*=|/=|%=|&amp;=|\|=|\^=|&lt;&lt;=|&gt;&gt;=|&lt;&lt;&lt;=|&gt;&gt;&gt;="                                       : Token;
Operator11Term        : &lt;INITIAL                &gt;"\*\*"                                                                                : Token;
Operator10Term        : &lt;INITIAL                &gt;"/|%"                                                                                 : Token;
Operator09Term        : &lt;INITIAL                &gt;"\+|-"                                                                                : Token;
Operator08Term        : &lt;INITIAL                &gt;"&lt;&lt;&lt;|&gt;&gt;&gt;|&lt;&lt;|&gt;&gt;"                                                                       : Token;
Operator07Term        : &lt;INITIAL                &gt;"&lt;=|&gt;=|&lt;:|&gt;:"                                                                         : Token;
Operator06Term        : &lt;INITIAL                &gt;"===|==\?|!==|!=\?|==|!="                                                             : Token;
Operator02Term        : &lt;INITIAL                &gt;"&amp;&amp;"                                                                                  : Token;
Operator01Term        : &lt;INITIAL                &gt;"\|\|"                                                                                : Token;
Operator05Term        : &lt;INITIAL                &gt;"&amp;"                                                                                   : Token;
Operator04Term        : &lt;INITIAL                &gt;"\^~|\^|~\^"                                                                          : Token;
Operator03Term        : &lt;INITIAL                &gt;"\|"                                                                                  : Token;
UnaryOperatorTerm     : &lt;INITIAL                &gt;"~&amp;|~\||!|~"                                                                          : Token;
ColonColonLAngleTerm  : &lt;INITIAL, Generic       &gt;'::&lt;'                                                                                 : Token;
ColonColonTerm        : &lt;INITIAL, Generic       &gt;'::'                                                                                  : Token;
ColonTerm             : &lt;INITIAL, Generic       &gt;':'                                                                                   : Token;
CommaTerm             : &lt;INITIAL, Generic       &gt;','                                                                                   : Token;
DotDotEquTerm         : &lt;INITIAL, Generic       &gt;'..='                                                                                 : Token;
DotDotTerm            : &lt;INITIAL, Generic       &gt;'..'                                                                                  : Token;
DotTerm               : &lt;INITIAL, Generic       &gt;'.'                                                                                   : Token;
EquTerm               : &lt;INITIAL, Generic       &gt;'='                                                                                   : Token;
HashTerm              : &lt;INITIAL, Generic       &gt;'#'                                                                                   : Token;
LAngleTerm            : &lt;INITIAL, Generic       &gt;'&lt;'                                                                                   : Token;
QuoteLBraceTerm       : &lt;INITIAL, Generic       &gt;"'\{"                                                                                 : Token;
LBraceTerm            : &lt;INITIAL, Generic, Embed&gt;'{'                                                                                   : Token;
LBracketTerm          : &lt;INITIAL, Generic       &gt;'['                                                                                   : Token;
LParenTerm            : &lt;INITIAL, Generic       &gt;'('                                                                                   : Token;
RAngleTerm            : &lt;INITIAL, Generic       &gt;'&gt;'                                                                                   : Token;
RBraceTerm            : &lt;INITIAL, Generic, Embed&gt;'}'                                                                                   : Token;
RBracketTerm          : &lt;INITIAL, Generic       &gt;']'                                                                                   : Token;
RParenTerm            : &lt;INITIAL, Generic       &gt;')'                                                                                   : Token;
SemicolonTerm         : &lt;INITIAL, Generic       &gt;';'                                                                                   : Token;
StarTerm              : &lt;INITIAL, Generic       &gt;'*'                                                                                   : Token;
AlwaysCombTerm        : &lt;INITIAL, Generic       &gt;/(?-u:\b)always_comb(?-u:\b)/                                                         : Token;
AlwaysFfTerm          : &lt;INITIAL, Generic       &gt;/(?-u:\b)always_ff(?-u:\b)/                                                           : Token;
AssignTerm            : &lt;INITIAL, Generic       &gt;/(?-u:\b)assign(?-u:\b)/                                                              : Token;
AsTerm                : &lt;INITIAL, Generic       &gt;/(?-u:\b)as(?-u:\b)/                                                                  : Token;
BitTerm               : &lt;INITIAL, Generic       &gt;/(?-u:\b)bit(?-u:\b)/                                                                 : Token;
CaseTerm              : &lt;INITIAL, Generic       &gt;/(?-u:\b)case(?-u:\b)/                                                                : Token;
ClockTerm             : &lt;INITIAL, Generic       &gt;/(?-u:\b)clock(?-u:\b)/                                                               : Token;
ClockPosedgeTerm      : &lt;INITIAL, Generic       &gt;/(?-u:\b)clock_posedge(?-u:\b)/                                                       : Token;
ClockNegedgeTerm      : &lt;INITIAL, Generic       &gt;/(?-u:\b)clock_negedge(?-u:\b)/                                                       : Token;
DefaultTerm           : &lt;INITIAL, Generic       &gt;/(?-u:\b)default(?-u:\b)/                                                             : Token;
ElseTerm              : &lt;INITIAL, Generic       &gt;/(?-u:\b)else(?-u:\b)/                                                                : Token;
EmbedTerm             : &lt;INITIAL, Generic       &gt;/(?-u:\b)embed(?-u:\b)/                                                               : Token;
EnumTerm              : &lt;INITIAL, Generic       &gt;/(?-u:\b)enum(?-u:\b)/                                                                : Token;
ExportTerm            : &lt;INITIAL, Generic       &gt;/(?-u:\b)export(?-u:\b)/                                                              : Token;
F32Term               : &lt;INITIAL, Generic       &gt;/(?-u:\b)f32(?-u:\b)/                                                                 : Token;
F64Term               : &lt;INITIAL, Generic       &gt;/(?-u:\b)f64(?-u:\b)/                                                                 : Token;
FinalTerm             : &lt;INITIAL, Generic       &gt;/(?-u:\b)final(?-u:\b)/                                                               : Token;
ForTerm               : &lt;INITIAL, Generic       &gt;/(?-u:\b)for(?-u:\b)/                                                                 : Token;
FunctionTerm          : &lt;INITIAL, Generic       &gt;/(?-u:\b)function(?-u:\b)/                                                            : Token;
I32Term               : &lt;INITIAL, Generic       &gt;/(?-u:\b)i32(?-u:\b)/                                                                 : Token;
I64Term               : &lt;INITIAL, Generic       &gt;/(?-u:\b)i64(?-u:\b)/                                                                 : Token;
IfResetTerm           : &lt;INITIAL, Generic       &gt;/(?-u:\b)if_reset(?-u:\b)/                                                            : Token;
IfTerm                : &lt;INITIAL, Generic       &gt;/(?-u:\b)if(?-u:\b)/                                                                  : Token;
ImportTerm            : &lt;INITIAL, Generic       &gt;/(?-u:\b)import(?-u:\b)/                                                              : Token;
IncludeTerm           : &lt;INITIAL, Generic       &gt;/(?-u:\b)include(?-u:\b)/                                                             : Token;
InitialTerm           : &lt;INITIAL, Generic       &gt;/(?-u:\b)initial(?-u:\b)/                                                             : Token;
InoutTerm             : &lt;INITIAL, Generic       &gt;/(?-u:\b)inout(?-u:\b)/                                                               : Token;
InputTerm             : &lt;INITIAL, Generic       &gt;/(?-u:\b)input(?-u:\b)/                                                               : Token;
InsideTerm            : &lt;INITIAL, Generic       &gt;/(?-u:\b)inside(?-u:\b)/                                                              : Token;
InstTerm              : &lt;INITIAL, Generic       &gt;/(?-u:\b)inst(?-u:\b)/                                                                : Token;
InterfaceTerm         : &lt;INITIAL, Generic       &gt;/(?-u:\b)interface(?-u:\b)/                                                           : Token;
InTerm                : &lt;INITIAL, Generic       &gt;/(?-u:\b)in(?-u:\b)/                                                                  : Token;
LetTerm               : &lt;INITIAL, Generic       &gt;/(?-u:\b)let(?-u:\b)/                                                                 : Token;
LocalTerm             : &lt;INITIAL, Generic       &gt;/(?-u:\b)local(?-u:\b)/                                                               : Token;
LogicTerm             : &lt;INITIAL, Generic       &gt;/(?-u:\b)logic(?-u:\b)/                                                               : Token;
LsbTerm               : &lt;INITIAL, Generic       &gt;/(?-u:\b)lsb(?-u:\b)/                                                                 : Token;
ModportTerm           : &lt;INITIAL, Generic       &gt;/(?-u:\b)modport(?-u:\b)/                                                             : Token;
ModuleTerm            : &lt;INITIAL, Generic       &gt;/(?-u:\b)module(?-u:\b)/                                                              : Token;
MsbTerm               : &lt;INITIAL, Generic       &gt;/(?-u:\b)msb(?-u:\b)/                                                                 : Token;
OutputTerm            : &lt;INITIAL, Generic       &gt;/(?-u:\b)output(?-u:\b)/                                                              : Token;
OutsideTerm           : &lt;INITIAL, Generic       &gt;/(?-u:\b)outside(?-u:\b)/                                                             : Token;
PackageTerm           : &lt;INITIAL, Generic       &gt;/(?-u:\b)package(?-u:\b)/                                                             : Token;
ParamTerm             : &lt;INITIAL, Generic       &gt;/(?-u:\b)param(?-u:\b)/                                                               : Token;
PubTerm               : &lt;INITIAL, Generic       &gt;/(?-u:\b)pub(?-u:\b)/                                                                 : Token;
RefTerm               : &lt;INITIAL, Generic       &gt;/(?-u:\b)ref(?-u:\b)/                                                                 : Token;
RepeatTerm            : &lt;INITIAL, Generic       &gt;/(?-u:\b)repeat(?-u:\b)/                                                              : Token;
ResetTerm             : &lt;INITIAL, Generic       &gt;/(?-u:\b)reset(?-u:\b)/                                                               : Token;
ResetAsyncHighTerm    : &lt;INITIAL, Generic       &gt;/(?-u:\b)reset_async_high(?-u:\b)/                                                    : Token;
ResetAsyncLowTerm     : &lt;INITIAL, Generic       &gt;/(?-u:\b)reset_async_low(?-u:\b)/                                                     : Token;
ResetSyncHighTerm     : &lt;INITIAL, Generic       &gt;/(?-u:\b)reset_sync_high(?-u:\b)/                                                     : Token;
ResetSyncLowTerm      : &lt;INITIAL, Generic       &gt;/(?-u:\b)reset_sync_low(?-u:\b)/                                                      : Token;
ReturnTerm            : &lt;INITIAL, Generic       &gt;/(?-u:\b)return(?-u:\b)/                                                              : Token;
BreakTerm             : &lt;INITIAL, Generic       &gt;/(?-u:\b)break(?-u:\b)/                                                               : Token;
SignedTerm            : &lt;INITIAL, Generic       &gt;/(?-u:\b)signed(?-u:\b)/                                                              : Token;
StepTerm              : &lt;INITIAL, Generic       &gt;/(?-u:\b)step(?-u:\b)/                                                                : Token;
StringTerm            : &lt;INITIAL, Generic       &gt;/(?-u:\b)string(?-u:\b)/                                                              : Token;
StructTerm            : &lt;INITIAL, Generic       &gt;/(?-u:\b)struct(?-u:\b)/                                                              : Token;
TriTerm               : &lt;INITIAL, Generic       &gt;/(?-u:\b)tri(?-u:\b)/                                                                 : Token;
TypeTerm              : &lt;INITIAL, Generic       &gt;/(?-u:\b)type(?-u:\b)/                                                                : Token;
U32Term               : &lt;INITIAL, Generic       &gt;/(?-u:\b)u32(?-u:\b)/                                                                 : Token;
U64Term               : &lt;INITIAL, Generic       &gt;/(?-u:\b)u64(?-u:\b)/                                                                 : Token;
UnionTerm             : &lt;INITIAL, Generic       &gt;/(?-u:\b)union(?-u:\b)/                                                               : Token;
VarTerm               : &lt;INITIAL, Generic       &gt;/(?-u:\b)var(?-u:\b)/                                                                 : Token;
DollarIdentifierTerm  : &lt;INITIAL, Generic       &gt;/\$[a-zA-Z_][0-9a-zA-Z_$]*/                                                           : Token;
IdentifierTerm        : &lt;INITIAL, Generic       &gt;/[a-zA-Z_][0-9a-zA-Z_$]*/                                                             : Token;
AnyTerm               : &lt;                  Embed&gt;/[^{}]*/                                                                              : Token;

// ----------------------------------------------------------------------------
// Token
// ----------------------------------------------------------------------------

Comments: [ CommentsTerm ];

StartToken: Comments;

StringLiteralToken: StringLiteralTerm: Token Comments;

ExponentToken  : ExponentTerm  : Token Comments;
FixedPointToken: FixedPointTerm: Token Comments;
BasedToken     : BasedTerm     : Token Comments;
BaseLessToken  : BaseLessTerm  : Token Comments;
AllBitToken    : AllBitTerm    : Token Comments;

AssignmentOperatorToken: AssignmentOperatorTerm: Token Comments;
Operator01Token        : Operator01Term        : Token Comments;
Operator02Token        : Operator02Term        : Token Comments;
Operator03Token        : Operator03Term        : Token Comments;
Operator04Token        : Operator04Term        : Token Comments;
Operator05Token        : Operator05Term        : Token Comments;
Operator06Token        : Operator06Term        : Token Comments;
Operator07Token        : Operator07Term        : Token Comments;
Operator08Token        : Operator08Term        : Token Comments;
Operator09Token        : Operator09Term        : Token Comments;
Operator10Token        : Operator10Term        : Token Comments;
Operator11Token        : Operator11Term        : Token Comments;
UnaryOperatorToken     : UnaryOperatorTerm     : Token Comments;

ColonToken           : ColonTerm           : Token Comments;
ColonColonLAngleToken: ColonColonLAngleTerm: Token Comments;
ColonColonToken      : ColonColonTerm      : Token Comments;
CommaToken           : CommaTerm           : Token Comments;
DotDotToken          : DotDotTerm          : Token Comments;
DotDotEquToken       : DotDotEquTerm       : Token Comments;
DotToken             : DotTerm             : Token Comments;
EquToken             : EquTerm             : Token Comments;
HashToken            : HashTerm            : Token Comments;
QuoteLBraceToken     : QuoteLBraceTerm     : Token Comments;
LAngleToken          : LAngleTerm          : Token Comments;
LBraceToken          : LBraceTerm          : Token Comments;
LBracketToken        : LBracketTerm        : Token Comments;
LParenToken          : LParenTerm          : Token Comments;
MinusColonToken      : MinusColonTerm      : Token Comments;
MinusGTToken         : MinusGTTerm         : Token Comments;
PlusColonToken       : PlusColonTerm       : Token Comments;
RAngleToken          : RAngleTerm          : Token Comments;
RBraceToken          : RBraceTerm          : Token Comments;
RBracketToken        : RBracketTerm        : Token Comments;
RParenToken          : RParenTerm          : Token Comments;
SemicolonToken       : SemicolonTerm       : Token Comments;
StarToken            : StarTerm            : Token Comments;

AlwaysCombToken    : AlwaysCombTerm    : Token Comments;
AlwaysFfToken      : AlwaysFfTerm      : Token Comments;
AsToken            : AsTerm            : Token Comments;
AssignToken        : AssignTerm        : Token Comments;
BitToken           : BitTerm           : Token Comments;
CaseToken          : CaseTerm          : Token Comments;
ClockToken         : ClockTerm         : Token Comments;
ClockPosedgeToken  : ClockPosedgeTerm  : Token Comments;
ClockNegedgeToken  : ClockNegedgeTerm  : Token Comments;
DefaultToken       : DefaultTerm       : Token Comments;
ElseToken          : ElseTerm          : Token Comments;
EmbedToken         : EmbedTerm         : Token Comments;
EnumToken          : EnumTerm          : Token Comments;
ExportToken        : ExportTerm        : Token Comments;
F32Token           : F32Term           : Token Comments;
F64Token           : F64Term           : Token Comments;
FinalToken         : FinalTerm         : Token Comments;
ForToken           : ForTerm           : Token Comments;
FunctionToken      : FunctionTerm      : Token Comments;
I32Token           : I32Term           : Token Comments;
I64Token           : I64Term           : Token Comments;
IfResetToken       : IfResetTerm       : Token Comments;
IfToken            : IfTerm            : Token Comments;
ImportToken        : ImportTerm        : Token Comments;
IncludeToken       : IncludeTerm       : Token Comments;
InitialToken       : InitialTerm       : Token Comments;
InoutToken         : InoutTerm         : Token Comments;
InputToken         : InputTerm         : Token Comments;
InsideToken        : InsideTerm        : Token Comments;
InstToken          : InstTerm          : Token Comments;
InterfaceToken     : InterfaceTerm     : Token Comments;
InToken            : InTerm            : Token Comments;
LetToken           : LetTerm           : Token Comments;
LocalToken         : LocalTerm         : Token Comments;
LogicToken         : LogicTerm         : Token Comments;
LsbToken           : LsbTerm           : Token Comments;
ModportToken       : ModportTerm       : Token Comments;
ModuleToken        : ModuleTerm        : Token Comments;
MsbToken           : MsbTerm           : Token Comments;
OutputToken        : OutputTerm        : Token Comments;
OutsideToken       : OutsideTerm       : Token Comments;
PackageToken       : PackageTerm       : Token Comments;
ParamToken         : ParamTerm         : Token Comments;
PubToken           : PubTerm           : Token Comments;
RefToken           : RefTerm           : Token Comments;
RepeatToken        : RepeatTerm        : Token Comments;
ResetToken         : ResetTerm         : Token Comments;
ResetAsyncHighToken: ResetAsyncHighTerm: Token Comments;
ResetAsyncLowToken : ResetAsyncLowTerm : Token Comments;
ResetSyncHighToken : ResetSyncHighTerm : Token Comments;
ResetSyncLowToken  : ResetSyncLowTerm  : Token Comments;
ReturnToken        : ReturnTerm        : Token Comments;
BreakToken         : BreakTerm         : Token Comments;
SignedToken        : SignedTerm        : Token Comments;
StepToken          : StepTerm          : Token Comments;
StringToken        : StringTerm        : Token Comments;
StructToken        : StructTerm        : Token Comments;
TriToken           : TriTerm           : Token Comments;
TypeToken          : TypeTerm          : Token Comments;
U32Token           : U32Term           : Token Comments;
U64Token           : U64Term           : Token Comments;
UnionToken         : UnionTerm         : Token Comments;
VarToken           : VarTerm           : Token Comments;

DollarIdentifierToken: DollarIdentifierTerm: Token Comments;
IdentifierToken      : IdentifierTerm      : Token Comments;

// ----------------------------------------------------------------------------
// VerylToken
// ----------------------------------------------------------------------------

// Start
Start: StartToken: VerylToken;

// StringLiteral
StringLiteral: StringLiteralToken: VerylToken;

// Number
Exponent  : ExponentToken  : VerylToken;
FixedPoint: FixedPointToken: VerylToken;
Based     : BasedToken     : VerylToken;
BaseLess  : BaseLessToken  : VerylToken;
AllBit    : AllBitToken    : VerylToken;

// Operator
AssignmentOperator: AssignmentOperatorToken: VerylToken;
Operator01        : Operator01Token        : VerylToken;
Operator02        : Operator02Token        : VerylToken;
Operator03        : Operator03Token        : VerylToken;
Operator04        : Operator04Token        : VerylToken;
Operator05        : Operator05Token        : VerylToken;
Operator06        : Operator06Token        : VerylToken;
Operator07        : Operator07Token        : VerylToken;
Operator08        : Operator08Token        : VerylToken;
Operator09        : Operator09Token        : VerylToken;
Operator10        : Operator10Token        : VerylToken;
Operator11        : Operator11Token        : VerylToken;
UnaryOperator     : UnaryOperatorToken     : VerylToken;

// Symbol
Colon           : ColonToken           : VerylToken;
ColonColonLAngle: ColonColonLAngleToken: VerylToken;
ColonColon      : ColonColonToken      : VerylToken;
Comma           : CommaToken           : VerylToken;
DotDot          : DotDotToken          : VerylToken;
DotDotEqu       : DotDotEquToken       : VerylToken;
Dot             : DotToken             : VerylToken;
Equ             : EquToken             : VerylToken;
Hash            : HashToken            : VerylToken;
QuoteLBrace     : QuoteLBraceToken     : VerylToken;
LAngle          : LAngleToken          : VerylToken;
LBrace          : LBraceToken          : VerylToken;
LBracket        : LBracketToken        : VerylToken;
LParen          : LParenToken          : VerylToken;
MinusColon      : MinusColonToken      : VerylToken;
MinusGT         : MinusGTToken         : VerylToken;
PlusColon       : PlusColonToken       : VerylToken;
RAngle          : RAngleToken          : VerylToken;
RBrace          : RBraceToken          : VerylToken;
RBracket        : RBracketToken        : VerylToken;
RParen          : RParenToken          : VerylToken;
Semicolon       : SemicolonToken       : VerylToken;
Star            : StarToken            : VerylToken;

// Keyword
AlwaysComb    : AlwaysCombToken    : VerylToken;
AlwaysFf      : AlwaysFfToken      : VerylToken;
As            : AsToken            : VerylToken;
Assign        : AssignToken        : VerylToken;
Bit           : BitToken           : VerylToken;
Break         : BreakToken         : VerylToken;
Case          : CaseToken          : VerylToken;
Clock         : ClockToken         : VerylToken;
ClockPosedge  : ClockPosedgeToken  : VerylToken;
ClockNegedge  : ClockNegedgeToken  : VerylToken;
Defaul        : DefaultToken       : VerylToken; // avoid to conflict with Rust's Default trait
Else          : ElseToken          : VerylToken;
Embed         : EmbedToken         : VerylToken;
Enum          : EnumToken          : VerylToken;
Export        : ExportToken        : VerylToken;
F32           : F32Token           : VerylToken;
F64           : F64Token           : VerylToken;
Final         : FinalToken         : VerylToken;
For           : ForToken           : VerylToken;
Function      : FunctionToken      : VerylToken;
I32           : I32Token           : VerylToken;
I64           : I64Token           : VerylToken;
If            : IfToken            : VerylToken;
IfReset       : IfResetToken       : VerylToken;
Import        : ImportToken        : VerylToken;
In            : InToken            : VerylToken;
Include       : IncludeToken       : VerylToken;
Initial       : InitialToken       : VerylToken;
Inout         : InoutToken         : VerylToken;
Input         : InputToken         : VerylToken;
Inside        : InsideToken        : VerylToken;
Inst          : InstToken          : VerylToken;
Interface     : InterfaceToken     : VerylToken;
Let           : LetToken           : VerylToken;
Local         : LocalToken         : VerylToken;
Logic         : LogicToken         : VerylToken;
Lsb           : LsbToken           : VerylToken;
Modport       : ModportToken       : VerylToken;
Module        : ModuleToken        : VerylToken;
Msb           : MsbToken           : VerylToken;
Output        : OutputToken        : VerylToken;
Outside       : OutsideToken       : VerylToken;
Package       : PackageToken       : VerylToken;
Param         : ParamToken         : VerylToken;
Pub           : PubToken           : VerylToken;
Ref           : RefToken           : VerylToken;
Repeat        : RepeatToken        : VerylToken;
Reset         : ResetToken         : VerylToken;
ResetAsyncHigh: ResetAsyncHighToken: VerylToken;
ResetAsyncLow : ResetAsyncLowToken : VerylToken;
ResetSyncHigh : ResetSyncHighToken : VerylToken;
ResetSyncLow  : ResetSyncLowToken  : VerylToken;
Return        : ReturnToken        : VerylToken;
Signed        : SignedToken        : VerylToken;
Step          : StepToken          : VerylToken;
Strin         : StringToken        : VerylToken; // avoid to conflict with Rust's String struct
Struct        : StructToken        : VerylToken;
Tri           : TriToken           : VerylToken;
Type          : TypeToken          : VerylToken;
U32           : U32Token           : VerylToken;
U64           : U64Token           : VerylToken;
Union         : UnionToken         : VerylToken;
Var           : VarToken           : VerylToken;

// Identifier
DollarIdentifier: DollarIdentifierToken: VerylToken;
Identifier      : IdentifierToken      : VerylToken;

// ----------------------------------------------------------------------------
// Number
// ----------------------------------------------------------------------------

Number: IntegralNumber
      | RealNumber
      ;

IntegralNumber: Based
              | BaseLess
              | AllBit
              ;

RealNumber: FixedPoint
          | Exponent
          ;

// ----------------------------------------------------------------------------
// Complex Identifier
// ----------------------------------------------------------------------------

HierarchicalIdentifier: Identifier { Select } { Dot Identifier { Select } };
ScopedIdentifier      : ( DollarIdentifier | Identifier [ WithGenericArgument ] ) { ColonColon Identifier [ WithGenericArgument ] };
ExpressionIdentifier  : ScopedIdentifier { Select } { Dot Identifier { Select } };

// ----------------------------------------------------------------------------
// Expression
// ----------------------------------------------------------------------------

Expression  : Expression01 { Operator01 Expression01 };
Expression01: Expression02 { Operator02 Expression02 };
Expression02: Expression03 { Operator03 Expression03 };
Expression03: Expression04 { Operator04 Expression04 };
Expression04: Expression05 { Operator05 Expression05 };
Expression05: Expression06 { Operator06 Expression06 };
Expression06: Expression07 { Operator07 Expression07 };
Expression07: Expression08 { Operator08 Expression08 };
Expression08: Expression09 { Operator09 Expression09 };
Expression09: Expression10 { ( Operator10 | Star ) Expression10 };
Expression10: Expression11 { Operator11 Expression11 };
Expression11: Expression12 { As ScopedIdentifier };
Expression12: { ( UnaryOperator | Operator09 | Operator05 | Operator03 | Operator04 ) } Factor;

Factor: Number
      | ExpressionIdentifier [ FunctionCall ]
      | LParen Expression RParen
      | LBrace ConcatenationList RBrace
      | QuoteLBrace ArrayLiteralList RBrace
      | IfExpression
      | CaseExpression
      | StringLiteral
      | ( Msb | Lsb )
      | InsideExpression
      | OutsideExpression
      ;

FunctionCall: LParen [ ArgumentList ] RParen;

ArgumentList: ArgumentItem { Comma ArgumentItem } [ Comma ];

ArgumentItem: Expression;

ConcatenationList: ConcatenationItem { Comma ConcatenationItem } [ Comma ];

ConcatenationItem: Expression [ Repeat Expression ];

ArrayLiteralList: ArrayLiteralItem { Comma ArrayLiteralItem } [ Comma ];

ArrayLiteralItem: ( Expression [ Repeat Expression ] | Defaul Colon Expression );

IfExpression: If Expression LBrace Expression RBrace { Else If Expression LBrace Expression RBrace } Else LBrace Expression RBrace;

CaseExpression: Case Expression LBrace Expression { Comma Expression } Colon Expression Comma { Expression { Comma Expression } Colon Expression Comma } Defaul Colon Expression [ Comma ] RBrace;

TypeExpression: ScalarType
              | Type LParen Expression RParen
              ;

InsideExpression: Inside Expression LBrace RangeList RBrace;

OutsideExpression: Outside Expression LBrace RangeList RBrace;

RangeList: RangeItem { Comma RangeItem } [ Comma ];

RangeItem: Range;

// ----------------------------------------------------------------------------
// Select / Width / Array / Range
// ----------------------------------------------------------------------------

Select: LBracket Expression [ SelectOperator Expression ] RBracket;

SelectOperator: Colon
              | PlusColon
              | MinusColon
              | Step
              ;

Width: LAngle Expression { Comma Expression } RAngle;

Array: LBracket Expression { Comma Expression } RBracket;

Range: Expression [ RangeOperator Expression ];

RangeOperator: DotDot
             | DotDotEqu
             ;

// ----------------------------------------------------------------------------
// ScalarType / ArrayType
// ----------------------------------------------------------------------------

FixedType: U32 | U64 | I32 | I64 | F32 | F64 | Strin;

VariableType: ( Clock
              | ClockPosedge
              | ClockNegedge
              | Reset
              | ResetAsyncHigh
              | ResetAsyncLow
              | ResetSyncHigh
              | ResetSyncLow
              | Logic
              | Bit
              | ScopedIdentifier
              ) [ Width ];

TypeModifier: Tri | Signed;

ScalarType: { TypeModifier } ( VariableType | FixedType );

ArrayType: ScalarType [ Array ];

// ----------------------------------------------------------------------------
// Statement
// ----------------------------------------------------------------------------

Statement: LetStatement
         | IdentifierStatement
         | IfStatement
         | IfResetStatement
         | ReturnStatement
         | BreakStatement
         | ForStatement
         | CaseStatement
         ;

LetStatement: Let Identifier Colon ArrayType Equ Expression Semicolon;

IdentifierStatement: ExpressionIdentifier ( FunctionCall | Assignment ) Semicolon;

Assignment: ( Equ | AssignmentOperator ) Expression;

IfStatement: If Expression LBrace { Statement } RBrace { Else If Expression LBrace { Statement } RBrace } [ Else LBrace { Statement } RBrace ];

IfResetStatement: IfReset LBrace { Statement } RBrace { Else If Expression LBrace { Statement } RBrace } [ Else LBrace { Statement } RBrace ];

ReturnStatement: Return Expression Semicolon;

BreakStatement: Break Semicolon;

ForStatement: For Identifier Colon ScalarType In Range [ Step AssignmentOperator Expression ] LBrace { Statement } RBrace;

CaseStatement: Case Expression LBrace { CaseItem } RBrace;

CaseItem: ( Expression { Comma Expression } | Defaul ) Colon ( Statement | LBrace { Statement } RBrace );

// ----------------------------------------------------------------------------
// Attribute
// ----------------------------------------------------------------------------

Attribute: Hash LBracket Identifier [ LParen AttributeList RParen ] RBracket;

AttributeList: AttributeItem { Comma AttributeItem } [ Comma ];

AttributeItem: Identifier
             | StringLiteral
             ;

// ----------------------------------------------------------------------------
// Declaration
// ----------------------------------------------------------------------------

LetDeclaration: Let Identifier Colon ArrayType Equ Expression Semicolon;

VarDeclaration: Var Identifier Colon ArrayType Semicolon;

LocalDeclaration: Local Identifier Colon ( ArrayType Equ Expression | Type Equ TypeExpression ) Semicolon;

TypeDefDeclaration: Type Identifier Equ ArrayType Semicolon;

AlwaysFfDeclaration: AlwaysFf [ AlwayfFfEventList ] LBrace { Statement } RBrace;

AlwayfFfEventList: LParen AlwaysFfClock [ Comma AlwaysFfReset ] RParen;

AlwaysFfClock: HierarchicalIdentifier;

AlwaysFfReset: HierarchicalIdentifier;

AlwaysCombDeclaration: AlwaysComb LBrace { Statement } RBrace;

AssignDeclaration: Assign HierarchicalIdentifier Equ Expression Semicolon;

ModportDeclaration: Modport Identifier LBrace ModportList RBrace;

ModportList: ModportGroup { Comma ModportGroup } [ Comma ];

ModportGroup: { Attribute } ( LBrace ModportList RBrace | ModportItem );

ModportItem: Identifier Colon Direction;

EnumDeclaration: Enum Identifier Colon ScalarType LBrace EnumList RBrace;

EnumList: EnumGroup { Comma EnumGroup } [ Comma ];

EnumGroup: { Attribute } ( LBrace EnumList RBrace | EnumItem );

EnumItem: Identifier [ Equ Expression ];

StructUnion: Struct | Union;

StructUnionDeclaration: StructUnion Identifier [ WithGenericParameter ] LBrace StructUnionList RBrace;

StructUnionList: StructUnionGroup { Comma StructUnionGroup } [ Comma ];

StructUnionGroup: { Attribute } ( LBrace StructUnionList RBrace | StructUnionItem );

StructUnionItem: Identifier Colon ScalarType;

InitialDeclaration: Initial LBrace { Statement } RBrace;

FinalDeclaration: Final LBrace { Statement } RBrace;

// ----------------------------------------------------------------------------
// InstDeclaration
// ----------------------------------------------------------------------------

InstDeclaration: Inst Identifier Colon ScopedIdentifier [ Array ] [ InstParameter ] [ LParen [ InstPortList ] RParen ] Semicolon;

InstParameter: Hash LParen [ InstParameterList ] RParen;

InstParameterList: InstParameterGroup { Comma InstParameterGroup } [ Comma ];

InstParameterGroup: { Attribute } ( LBrace InstParameterList RBrace | InstParameterItem );

InstParameterItem: Identifier [ Colon Expression ];

InstPortList: InstPortGroup { Comma InstPortGroup } [ Comma ];

InstPortGroup: { Attribute } ( LBrace InstPortList RBrace | InstPortItem );

InstPortItem: Identifier [ Colon Expression ];

// ----------------------------------------------------------------------------
// WithParameter
// ----------------------------------------------------------------------------

WithParameter: Hash LParen [ WithParameterList ] RParen;

WithParameterList: WithParameterGroup { Comma WithParameterGroup } [ Comma ];

WithParameterGroup: { Attribute } ( LBrace WithParameterList RBrace | WithParameterItem );

WithParameterItem: ( Param | Local ) Identifier Colon ( ArrayType Equ Expression | Type Equ TypeExpression );

// ----------------------------------------------------------------------------
// WithGenericParameter
// ----------------------------------------------------------------------------

WithGenericParameter: ColonColonLAngle WithGenericParameterList RAngle;

WithGenericParameterList: WithGenericParameterItem { Comma WithGenericParameterItem } [ Comma ];

WithGenericParameterItem: Identifier [ Equ WithGenericArgumentItem ];

// ----------------------------------------------------------------------------
// WithGenericArgument
// ----------------------------------------------------------------------------

WithGenericArgument: ColonColonLAngle %push(Generic) [ WithGenericArgumentList ] RAngle %pop();

WithGenericArgumentList: WithGenericArgumentItem { Comma WithGenericArgumentItem } [ Comma ];

WithGenericArgumentItem: ScopedIdentifier
                       | Number
                       ;

// ----------------------------------------------------------------------------
// PortDeclaration
// ----------------------------------------------------------------------------

PortDeclaration: LParen [ PortDeclarationList ] RParen;

PortDeclarationList: PortDeclarationGroup { Comma PortDeclarationGroup } [ Comma ];

PortDeclarationGroup: { Attribute } ( LBrace PortDeclarationList RBrace | PortDeclarationItem );

PortDeclarationItem: Identifier Colon ( Direction ArrayType | Interface [ Array ] );

Direction: Input
         | Output
         | Inout
         | Ref
         | Modport
         ;

// ----------------------------------------------------------------------------
// Function
// ----------------------------------------------------------------------------

FunctionDeclaration: Function Identifier [ WithGenericParameter ] [ PortDeclaration ] [ MinusGT ScalarType ] LBrace { FunctionItem } RBrace;

FunctionItem: VarDeclaration
            | Statement
            ;

// ----------------------------------------------------------------------------
// Import / Export
// ----------------------------------------------------------------------------

ImportDeclaration: Import ScopedIdentifier [ ColonColon Star ] Semicolon;

ExportDeclaration: Export ( Star | ScopedIdentifier [ ColonColon Star ] ) Semicolon;

// ----------------------------------------------------------------------------
// Module
// ----------------------------------------------------------------------------

ModuleDeclaration: [ Pub ] Module Identifier [ WithGenericParameter ] [ WithParameter ] [ PortDeclaration ] LBrace { ModuleGroup } RBrace;

ModuleIfDeclaration: If Expression ModuleNamedBlock { Else If Expression ModuleOptionalNamedBlock } [ Else ModuleOptionalNamedBlock ];

ModuleForDeclaration: For Identifier In Range [ Step AssignmentOperator Expression ] ModuleNamedBlock;

ModuleNamedBlock: Colon Identifier LBrace { ModuleGroup } RBrace;

ModuleOptionalNamedBlock: [ Colon Identifier ] LBrace { ModuleGroup } RBrace;

ModuleGroup: { Attribute } ( LBrace { ModuleGroup } RBrace | ModuleItem );

ModuleItem: LetDeclaration
          | VarDeclaration
          | InstDeclaration
          | TypeDefDeclaration
          | LocalDeclaration
          | AlwaysFfDeclaration
          | AlwaysCombDeclaration
          | AssignDeclaration
          | FunctionDeclaration
          | ModuleIfDeclaration
          | ModuleForDeclaration
          | EnumDeclaration
          | StructUnionDeclaration
          | ModuleNamedBlock
          | ImportDeclaration
          | InitialDeclaration
          | FinalDeclaration
          ;

// ----------------------------------------------------------------------------
// Interface
// ----------------------------------------------------------------------------

InterfaceDeclaration: [ Pub ] Interface Identifier [ WithGenericParameter ] [ WithParameter ] LBrace { InterfaceGroup } RBrace;

InterfaceIfDeclaration: If Expression InterfaceNamedBlock { Else If Expression InterfaceOptionalNamedBlock } [ Else InterfaceOptionalNamedBlock ];

InterfaceForDeclaration: For Identifier In Range [ Step AssignmentOperator Expression ] InterfaceNamedBlock;

InterfaceNamedBlock: Colon Identifier LBrace { InterfaceGroup } RBrace;

InterfaceOptionalNamedBlock: [ Colon Identifier ] LBrace { InterfaceGroup } RBrace;

InterfaceGroup: { Attribute } ( LBrace { InterfaceGroup } RBrace | InterfaceItem );

InterfaceItem: LetDeclaration
             | VarDeclaration
             | LocalDeclaration
             | ModportDeclaration
             | InterfaceIfDeclaration
             | InterfaceForDeclaration
             | TypeDefDeclaration
             | EnumDeclaration
             | StructUnionDeclaration
             | InterfaceNamedBlock
             | FunctionDeclaration
             | ImportDeclaration
             | InitialDeclaration
             | FinalDeclaration
             ;

// ----------------------------------------------------------------------------
// Package
// ----------------------------------------------------------------------------

PackageDeclaration: [ Pub ] Package Identifier [ WithGenericParameter ] LBrace { PackageGroup } RBrace;

PackageGroup: { Attribute } ( LBrace { PackageGroup } RBrace | PackageItem );

PackageItem: VarDeclaration
           | LocalDeclaration
           | TypeDefDeclaration
           | EnumDeclaration
           | StructUnionDeclaration
           | FunctionDeclaration
           | ImportDeclaration
           | ExportDeclaration
           | InitialDeclaration
           | FinalDeclaration
           ;

// ----------------------------------------------------------------------------
// Embed
// ----------------------------------------------------------------------------

EmbedDeclaration: Embed LParen Identifier RParen Identifier EmbedContent;

EmbedContent: EmbedContentToken: VerylToken;

EmbedContentToken: LBraceTerm %push(Embed) LBraceTerm LBraceTerm { EmbedItem } RBraceTerm RBraceTerm RBraceTerm %pop() Comments;

EmbedItem: LBraceTerm { EmbedItem } RBraceTerm
         | AnyTerm;

// ----------------------------------------------------------------------------
// Include
// ----------------------------------------------------------------------------

IncludeDeclaration: Include LParen Identifier Comma StringLiteral RParen Semicolon;

// ----------------------------------------------------------------------------
// Description
// ----------------------------------------------------------------------------

DescriptionGroup: { Attribute } ( LBrace { DescriptionGroup } RBrace | DescriptionItem );

DescriptionItem: ModuleDeclaration
               | InterfaceDeclaration
               | PackageDeclaration
               | ImportDeclaration
               | EmbedDeclaration
               | IncludeDeclaration
               ;

// ----------------------------------------------------------------------------
// SourceCode
// ----------------------------------------------------------------------------

Veryl: Start { DescriptionGroup };
</code></pre>
<div style="break-before: page; page-break-before: always;"></div><h1 id="セマンティックエラー"><a class="header" href="#セマンティックエラー">セマンティックエラー</a></h1>
<h2 id="duplicated_identifier"><a class="header" href="#duplicated_identifier">duplicated_identifier</a></h2>
<h2 id="invalid_allow"><a class="header" href="#invalid_allow">invalid_allow</a></h2>
<h2 id="invalid_direction"><a class="header" href="#invalid_direction">invalid_direction</a></h2>
<h2 id="invalid_identifier"><a class="header" href="#invalid_identifier">invalid_identifier</a></h2>
<h2 id="invalid_lsb"><a class="header" href="#invalid_lsb">invalid_lsb</a></h2>
<h2 id="invalid_msb"><a class="header" href="#invalid_msb">invalid_msb</a></h2>
<h2 id="invalid_number_character"><a class="header" href="#invalid_number_character">invalid_number_character</a></h2>
<h2 id="invalid_statement"><a class="header" href="#invalid_statement">invalid_statement</a></h2>
<h2 id="invalid_system_function"><a class="header" href="#invalid_system_function">invalid_system_function</a></h2>
<h2 id="mismatch_arity"><a class="header" href="#mismatch_arity">mismatch_arity</a></h2>
<h2 id="mismatch_attribute_args"><a class="header" href="#mismatch_attribute_args">mismatch_attribute_args</a></h2>
<h2 id="mismatch_type"><a class="header" href="#mismatch_type">mismatch_type</a></h2>
<h2 id="missing_if_reset"><a class="header" href="#missing_if_reset">missing_if_reset</a></h2>
<h2 id="missing_port"><a class="header" href="#missing_port">missing_port</a></h2>
<h2 id="missing_reset_signal"><a class="header" href="#missing_reset_signal">missing_reset_signal</a></h2>
<h2 id="missing_reset_statement"><a class="header" href="#missing_reset_statement">missing_reset_statement</a></h2>
<h2 id="too_large_enum_variant"><a class="header" href="#too_large_enum_variant">too_large_enum_variant</a></h2>
<h2 id="too_large_number"><a class="header" href="#too_large_number">too_large_number</a></h2>
<h2 id="too_much_enum_variant"><a class="header" href="#too_much_enum_variant">too_much_enum_variant</a></h2>
<h2 id="undefined_identifier"><a class="header" href="#undefined_identifier">undefined_identifier</a></h2>
<h2 id="unknown_attribute"><a class="header" href="#unknown_attribute">unknown_attribute</a></h2>
<h2 id="unknown_member"><a class="header" href="#unknown_member">unknown_member</a></h2>
<h2 id="unknown_msb"><a class="header" href="#unknown_msb">unknown_msb</a></h2>
<h2 id="unknown_port"><a class="header" href="#unknown_port">unknown_port</a></h2>
<h2 id="unused_variable"><a class="header" href="#unused_variable">unused_variable</a></h2>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->


                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">

            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>

        <script src="ace.js"></script>
        <script src="editor.js"></script>
        <script src="mode-rust.js"></script>
        <script src="theme-dawn.js"></script>
        <script src="theme-tomorrow_night.js"></script>

        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>
        <script type="module">
            import init, {build, format} from "https://doc.veryl-lang.org/nightly/playground/pkg/veryl_wasm.js";
            init().then(() => {});
            window.build = build;
        </script>

        <!-- Custom JS scripts -->
        <script src="mode-veryl.js"></script>
        <script src="editor.js"></script>

        <script>
        window.addEventListener('load', function() {
            window.setTimeout(window.print, 100);
        });
        </script>

    </div>
    </body>
</html>
